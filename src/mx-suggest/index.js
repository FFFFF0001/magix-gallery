define("mx-suggest/index",["magix","$","../mx-monitor/index"],(e,_,t)=>{let i=e("magix"),s=e("$"),l=e("../mx-monitor/index");i.applyStyle("_G","._eO{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._eP{padding:0 4px;cursor:pointer;margin:2px 0}._eQ{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._eR,._eQ:active,._eQ:focus,._eQ:hover{color:#333;background-color:#f0f0f0}._eR{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_eO _aj" style="width:<%=$$.width%>px" mx-mouseout="__eF()" mx-mousemove="__eG()" mx-contextmenu="__bY()">1</ul>',subs:[{keys:["width","rList","list","textKey","viewId"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_eP" title="<%=$$.textKey?a[$$.textKey]:a%>"><a href="#" class="_eQ _al" data-idx="<%!_%>" mx-click="__eE({item:\'<%@a%>\'})" id="sg_<%!$$.viewId%>_<%!_%>"><%=$$.textKey?a[$$.textKey]:a%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init(e){let _=this;_.__eu=e.list||[],l.__d(),_.on("destroy",function(){l.__f(_),l.__g(),_.__h.off("keyup paste input",_.__ev).off("focus",_.__ew),s("#suggest_"+_.id).remove()}),_.updater.set({viewId:_.id,textKey:e.textKey,valueKey:e.valueKey}),_.__ex=-1},__i(e){return i.inside(e,this.id)||i.inside(e,"suggest_"+this.id)},update(e,_){let t=this;_||(t.__eu=e),t.__ex=-1,t.updater.digest({list:t.__ey=e}),t.__dK&&(e&&e.length?t.__dK.addClass("_eO"):t.__dK.removeClass("_eO"))},render(){let e=this,_=s("#"+e.id);e.__h=_,_.on("focus",e.__ew=s.proxy(e.__e,e)).on("keyup paste input",e.__ev=s.proxy(e.__ez,e));let t="suggest_"+e.id;s("<div />").attr("id",t).insertAfter(_),e.updater.to(t),e.updater.set({width:_.outerWidth()}),e.update(e.__eu),e.__dK=s("#"+t+" ul"),e.__eu&&e.__eu.length||e.__dK.removeClass("_eO")},__ez(e){let _=this;_.__j||_.__e();let t=_.__ey;if(40==e.keyCode)_.__eA(),_.__ex++,_.__ex>=t.length&&(_.__ex=0),_.__eB();else if(38==e.keyCode)_.__eA(),_.__ex--,_.__ex<0&&(_.__ex=t.length-1),_.__eB();else if(13==e.keyCode){if(_.__ex>-1&&_.__ex<_.__ey.length){let e=_.__ey[_.__ex];_.__h.trigger({type:"pick",item:e});let t=_.updater.get("textKey");t&&(e=e[t]),_.__h.val(e).trigger("change"),_.__ez({target:_.__h[0]}),_.__eA(),_.__ex=-1,_.__a()}}else{let t=s.trim(e.target.value);if(t!=_.__eC)if(_.__eC=t,t){let e,i=[],s=_.__eu.slice(),l=_.updater.get("textKey");for(let _,d=0;d<s.length;d++)_=s[d],((e=l?_[l]:_)+"").indexOf(t)>=0&&i.push(_);_.update(i,!0)}else _.update(_.__eu,!0)}},__e(){let e=this,_=e.updater;if(!e.__j){e.__j=!0;_.get("rList")||_.digest({rList:!0}),l.__k(e);let t=e.__h.position();e.__dK.css({display:"block",left:t.left+e.$offsetLeft,top:t.top+e.__h.outerHeight()+5}),e.__h.trigger("showlist")}},__eA(){s("#sg_"+this.id+"_"+this.__ex).removeClass("_eR")},__eB(e){let _=this,t=s("#sg_"+_.id+"_"+_.__ex);if(t.addClass("_eR"),!e&&t.length){_.__eD=1;let e=t.outerHeight(),i=(_.__ex+1)*e,s=_.__dK,l=s.height(),d=s.prop("scrollTop"),r=Math.ceil(l/e);i<d+e?s.prop("scrollTop",i-e):i>d+l&&s.prop("scrollTop",(_.__ex+2-r)*e)}},__a(){let e=this;e.__j&&(e.__j=!1,l.__f(e),e.__dK.hide(),e.__h.trigger("hidelist"))},"__eE<click>"(e){e.preventDefault();let _=this,t=e.params.item;_.__h.trigger({type:"pick",item:t});let i=_.updater.get("textKey");i&&(t=t[i]),_.__h.val(t).trigger("change"),_.__ez({target:_.__h[0]}),_.__a()},"__eF<mouseout>"(e){if(!i.inside(e.relatedTarget,e.eventTarget)){this.__eA(),this.__ex=-1}},"__eG<mousemove>"(e){let _=this;if(_.__eD)return void delete _.__eD;let t=s(e.target);if(t.is("li")){let e=t.data("idx");e!=_.__ex&&(_.__eA(),_.__ex=e,_.__eB(!0))}},"__bY<contextmenu>"(e){e.preventDefault()}})});