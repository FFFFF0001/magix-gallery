define("mx-suggest/index",["magix","$","../mx-monitor/index"],function(e,_,t){var i=e("magix"),r=e("$"),a=e("../mx-monitor/index");i.applyStyle("_F","._eN{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._eO{padding:0 4px;cursor:pointer;margin:2px 0}._eP{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._eQ,._eP:active,._eP:focus,._eP:hover{color:#333;background-color:#f0f0f0}._eQ{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_eN _aj" style="width:<%=$$.width%>px" mx-mouseout="__eB()" mx-mousemove="__eC()" mx-contextmenu="__ca()">1</ul>',subs:[{keys:["width","rList","list","textKey","viewId"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_eO" title="<%=$$.textKey?b[$$.textKey]:b%>"><a href="#" class="_eP _al" data-idx="<%!a%>" mx-click="__eA({item:\'<%@b%>\'})" id="sg_<%!$$.viewId%>_<%!a%>"><%=$$.textKey?b[$$.textKey]:b%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init:function(e){var _=this;_.__eq=e.list||[],a.__d(),_.on("destroy",function(){a.__f(_),a.__g(),_.__h.off("keyup paste input",_.__er).off("focus",_.__es)}),_.updater.set({viewId:_.id,textKey:e.textKey,valueKey:e.valueKey}),_.__et=-1},__i:function(e){return i.inside(e,this.id)||i.inside(e,"suggest_"+this.id)},update:function(e,_){var t=this;_||(t.__eq=e),t.__et=-1,t.updater.digest({list:t.__eu=e}),t.__dN&&(e&&e.length?t.__dN.addClass("_eN"):t.__dN.removeClass("_eN"))},render:function(){var e=this,_=r("#"+e.id);e.__h=_,_.on("focus",e.__es=r.proxy(e.show,e)).on("keyup paste input",e.__er=r.proxy(e.__ev,e));var t="suggest_"+e.id;r("<div />").attr("id",t).insertAfter(_),e.updater.to(t),e.updater.set({width:_.outerWidth()}),e.update(e.__eq),e.__dN=r("#"+t+" ul"),e.__eq&&e.__eq.length||e.__dN.removeClass("_eN")},__ev:function(e){var _=this;_.__j||_.__e();var t=_.__eu;if(40==e.keyCode)_.__ew(),_.__et++,_.__et>=t.length&&(_.__et=0),_.__ex();else if(38==e.keyCode)_.__ew(),_.__et--,_.__et<0&&(_.__et=t.length-1),_.__ex();else if(13==e.keyCode){if(_.__et>-1&&_.__et<_.__eu.length){var i=_.__eu[_.__et];_.__h.trigger({type:"pick",item:i});var a=_.updater.get("textKey");a&&(i=i[a]),_.__h.val(i).trigger("change"),_.__ev({target:_.__h[0]}),_.__ew(),_.__et=-1,_.__a()}}else{var s=r.trim(e.target.value);if(s!=_.__ey)if(_.__ey=s,s){for(var o=[],d=_.__eq.slice(),n=_.updater.get("textKey"),l=0,u=void 0;l<d.length;l++)u=d[l],((n?u[n]:u)+"").indexOf(s)>=0&&o.push(u);_.update(o,!0)}else _.update(_.__eq,!0)}},__e:function(){var e=this,_=e.updater;if(!e.__j){e.__j=!0,_.get("rList")||_.digest({rList:!0}),a.__k(e);var t=e.__h.position();e.__dN.css({display:"block",left:t.left+e.$offsetLeft,top:t.top+e.__h.outerHeight()+5}),e.__h.trigger("showlist")}},__ew:function(){var e=this;r("#sg_"+e.id+"_"+e.__et).removeClass("_eQ")},__ex:function(e){var _=this,t=r("#sg_"+_.id+"_"+_.__et);if(t.addClass("_eQ"),!e&&t.length){_.__ez=1;var i=t.outerHeight(),a=(_.__et+1)*i,s=_.__dN,o=s.height(),d=s.prop("scrollTop"),n=Math.ceil(o/i);a<d+i?s.prop("scrollTop",a-i):a>d+o&&s.prop("scrollTop",(_.__et+2-n)*i)}},__a:function(){var e=this;e.__j&&(e.__j=!1,a.__f(e),e.__dN.hide(),e.__h.trigger("hidelist"))},"__eA<click>":function(e){e.preventDefault();var _=this,t=e.params.item;_.__h.trigger({type:"pick",item:t});var i=_.updater.get("textKey");i&&(t=t[i]),_.__h.val(t).trigger("change"),_.__ev({target:_.__h[0]}),_.__a()},"__eB<mouseout>":function(e){if(!i.inside(e.relatedTarget,e.eventTarget)){var _=this;_.__ew(),_.__et=-1}},"__eC<mousemove>":function(e){var _=this;if(_.__ez)delete _.__ez;else{var t=r(e.target);if(t.is("li")){var i=t.data("idx");i!=_.__et&&(_.__ew(),_.__et=i,_.__ex(!0))}}},"__ca<contextmenu>":function(e){e.preventDefault()}})});