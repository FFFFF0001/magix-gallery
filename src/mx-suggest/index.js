define("mx-suggest/index",["magix","$","../mx-monitor/index"],function(e,_,t){var i=e("magix"),r=e("$"),a=e("../mx-monitor/index");i.applyStyle("_F","._eI{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._eJ{padding:0 4px;cursor:pointer;margin:2px 0}._eK{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._eL,._eK:active,._eK:focus,._eK:hover{color:#333;background-color:#f0f0f0}._eL{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_eI _ai" style="width:<%=$$.width%>px" mx-mouseout="__ep()" mx-mousemove="__eq()" mx-contextmenu="__bR()">1</ul>',subs:[{keys:["width","rList","list","textKey","viewId"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_eJ" title="<%=$$.textKey?b[$$.textKey]:b%>"><a href="#" class="_eK _ak" data-idx="<%!a%>" mx-click="__eo({item:\'<%@b%>\'})" id="sg_<%!$$.viewId%>_<%!a%>"><%=$$.textKey?b[$$.textKey]:b%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init:function(e){var _=this;_.__ee=e.list||[],a.__d(),_.on("destroy",function(){a.__f(_),a.__g(),_.__h.off("keyup paste input",_.__ef).off("focus",_.__eg)}),_.updater.set({viewId:_.id,textKey:e.textKey,valueKey:e.valueKey}),_.__eh=-1},__i:function(e){return i.inside(e,this.id)||i.inside(e,"suggest_"+this.id)},update:function(e,_){var t=this;_||(t.__ee=e),t.__eh=-1,t.updater.digest({list:t.__ei=e}),t.__dB&&(e&&e.length?t.__dB.addClass("_eI"):t.__dB.removeClass("_eI"))},render:function(){var e=this,_=r("#"+e.id);e.__h=_,_.on("focus",e.__eg=r.proxy(e.show,e)).on("keyup paste input",e.__ef=r.proxy(e.__ej,e));var t="suggest_"+e.id;r("<div />").attr("id",t).insertAfter(_),e.updater.to(t),e.updater.set({width:_.outerWidth()}),e.update(e.__ee),e.__dB=r("#"+t+" ul"),e.__ee&&e.__ee.length||e.__dB.removeClass("_eI")},__ej:function(e){var _=this;_.__j||_.__e();var t=_.__ei;if(40==e.keyCode)_.__ek(),_.__eh++,_.__eh>=t.length&&(_.__eh=0),_.__el();else if(38==e.keyCode)_.__ek(),_.__eh--,_.__eh<0&&(_.__eh=t.length-1),_.__el();else if(13==e.keyCode){if(_.__eh>-1&&_.__eh<_.__ei.length){var i=_.__ei[_.__eh];_.__h.trigger({type:"pick",item:i});var a=_.updater.get("textKey");a&&(i=i[a]),_.__h.val(i).trigger("change"),_.__ej({target:_.__h[0]}),_.__ek(),_.__eh=-1,_.__a()}}else{var s=r.trim(e.target.value);if(s!=_.__em)if(_.__em=s,s){for(var o=[],d=_.__ee.slice(),n=_.updater.get("textKey"),l=0,h=void 0;l<d.length;l++)h=d[l],((n?h[n]:h)+"").indexOf(s)>=0&&o.push(h);_.update(o,!0)}else _.update(_.__ee,!0)}},__e:function(){var e=this,_=e.updater;if(!e.__j){e.__j=!0,_.get("rList")||_.digest({rList:!0}),a.__k(e);var t=e.__h.position();e.__dB.css({display:"block",left:t.left+e.$offsetLeft,top:t.top+e.__h.outerHeight()+5}),e.__h.trigger("showlist")}},__ek:function(){var e=this;r("#sg_"+e.id+"_"+e.__eh).removeClass("_eL")},__el:function(e){var _=this,t=r("#sg_"+_.id+"_"+_.__eh);if(t.addClass("_eL"),!e&&t.length){_.__en=1;var i=t.outerHeight(),a=(_.__eh+1)*i,s=_.__dB,o=s.height(),d=s.prop("scrollTop"),n=Math.ceil(o/i);a<d+i?s.prop("scrollTop",a-i):a>d+o&&s.prop("scrollTop",(_.__eh+2-n)*i)}},__a:function(){var e=this;e.__j&&(e.__j=!1,a.__f(e),e.__dB.hide(),e.__h.trigger("hidelist"))},"__eo<click>":function(e){e.preventDefault();var _=this,t=e.params.item;_.__h.trigger({type:"pick",item:t});var i=_.updater.get("textKey");i&&(t=t[i]),_.__h.val(t).trigger("change"),_.__ej({target:_.__h[0]}),_.__a()},"__ep<mouseout>":function(e){if(!i.inside(e.relatedTarget,e.eventTarget)){var _=this;_.__ek(),_.__eh=-1}},"__eq<mousemove>":function(e){var _=this;if(_.__en)delete _.__en;else{var t=r(e.target);if(t.is("li")){var i=t.data("idx");i!=_.__eh&&(_.__ek(),_.__eh=i,_.__el(!0))}}},"__bR<contextmenu>":function(e){e.preventDefault()}})});