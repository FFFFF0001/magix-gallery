define("mx-suggest/index",["magix","$","../mx-monitor/index"],function(e,_,t){var i=e("magix"),r=e("$"),s=e("../mx-monitor/index");i.applyStyle("_F","._eK{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._eL{padding:0 4px;cursor:pointer;margin:2px 0}._eM{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._eN,._eM:active,._eM:focus,._eM:hover{color:#333;background-color:#f0f0f0}._eN{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_eK _ai" style="width:<%=$$.width%>px" mx-mouseout="__er()" mx-mousemove="__es()" mx-contextmenu="__bR()">1</ul>',subs:[{keys:["width","rList","list","textKey","viewId"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_eL" title="<%=$$.textKey?b[$$.textKey]:b%>"><a href="#" class="_eM _ak" data-idx="<%!a%>" mx-click="__eq({item:\'<%@b%>\'})" id="sg_<%!$$.viewId%>_<%!a%>"><%=$$.textKey?b[$$.textKey]:b%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init:function(e){var _=this;_.__eg=e.list||[],s.__d(),_.on("destroy",function(){s.__f(_),s.__g(),_.__h.off("keyup paste input",_.__eh).off("focus",_.__ei)}),_.updater.set({viewId:_.id,textKey:e.textKey,valueKey:e.valueKey}),_.__ej=-1},__i:function(e){return i.inside(e,this.id)||i.inside(e,"suggest_"+this.id)},update:function(e,_){var t=this;_||(t.__eg=e),t.__ej=-1,t.updater.digest({list:t.__ek=e}),t.__dD&&(e&&e.length?t.__dD.addClass("_eK"):t.__dD.removeClass("_eK"))},render:function(){var e=this,_=r("#"+e.id);e.__h=_,_.on("focus",e.__ei=r.proxy(e.show,e)).on("keyup paste input",e.__eh=r.proxy(e.__el,e));var t="suggest_"+e.id;r("<div />").attr("id",t).insertAfter(_),e.updater.to(t),e.updater.set({width:_.outerWidth()}),e.update(e.__eg),e.__dD=r("#"+t+" ul"),e.__eg&&e.__eg.length||e.__dD.removeClass("_eK")},__el:function(e){var _=this;_.__j||_.__e();var t=_.__ek;if(40==e.keyCode)_.__em(),_.__ej++,_.__ej>=t.length&&(_.__ej=0),_.__en();else if(38==e.keyCode)_.__em(),_.__ej--,_.__ej<0&&(_.__ej=t.length-1),_.__en();else if(13==e.keyCode){if(_.__ej>-1&&_.__ej<_.__ek.length){var i=_.__ek[_.__ej];_.__h.trigger({type:"pick",item:i});var s=_.updater.get("textKey");s&&(i=i[s]),_.__h.val(i).trigger("change"),_.__el({target:_.__h[0]}),_.__em(),_.__ej=-1,_.__a()}}else{var a=r.trim(e.target.value);if(a!=_.__eo)if(_.__eo=a,a){for(var o=[],d=_.__eg.slice(),n=_.updater.get("textKey"),l=0,p=void 0;l<d.length;l++)p=d[l],((n?p[n]:p)+"").indexOf(a)>=0&&o.push(p);_.update(o,!0)}else _.update(_.__eg,!0)}},__e:function(){var e=this,_=e.updater;if(!e.__j){e.__j=!0,_.get("rList")||_.digest({rList:!0}),s.__k(e);var t=e.__h.position();e.__dD.css({display:"block",left:t.left+e.$offsetLeft,top:t.top+e.__h.outerHeight()+5}),e.__h.trigger("showlist")}},__em:function(){var e=this;r("#sg_"+e.id+"_"+e.__ej).removeClass("_eN")},__en:function(e){var _=this,t=r("#sg_"+_.id+"_"+_.__ej);if(t.addClass("_eN"),!e&&t.length){_.__ep=1;var i=t.outerHeight(),s=(_.__ej+1)*i,a=_.__dD,o=a.height(),d=a.prop("scrollTop"),n=Math.ceil(o/i);s<d+i?a.prop("scrollTop",s-i):s>d+o&&a.prop("scrollTop",(_.__ej+2-n)*i)}},__a:function(){var e=this;e.__j&&(e.__j=!1,s.__f(e),e.__dD.hide(),e.__h.trigger("hidelist"))},"__eq<click>":function(e){e.preventDefault();var _=this,t=e.params.item;_.__h.trigger({type:"pick",item:t});var i=_.updater.get("textKey");i&&(t=t[i]),_.__h.val(t).trigger("change"),_.__el({target:_.__h[0]}),_.__a()},"__er<mouseout>":function(e){if(!i.inside(e.relatedTarget,e.eventTarget)){var _=this;_.__em(),_.__ej=-1}},"__es<mousemove>":function(e){var _=this;if(_.__ep)delete _.__ep;else{var t=r(e.target);if(t.is("li")){var i=t.data("idx");i!=_.__ej&&(_.__em(),_.__ej=i,_.__en(!0))}}},"__bR<contextmenu>":function(e){e.preventDefault()}})});