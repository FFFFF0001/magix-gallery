define("mx-tree/branch",["magix","$","./branch"],function(e,i,a){e("./branch");var t=e("magix"),n=e("$"),r=t.Vframe;a.exports=t.View.extend({tmpl:{html:'<ul mx-guid="g0">1</ul>',subs:[{keys:["list","fromTop","valueKey","textKey"],path:'ul[mx-guid="g0"]',tmpl:'<%for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_fy<%if(!a&&$$.fromTop){%> _fE<%}if(a==$$.list.length-1){%> _fD<%}%>"><div class="_fz<%if(b.children){%> _ad<%}%>" <%if(b.children){%> mx-click="__aA({id:\'<%=$eq(b[$$.valueKey])%>\'})" <%}%>><%if(b.children){%><span class="_fA">+</span><%}%></div><div class="_fB"><label class="_fC"><input class="_as _fG _aa" type="checkbox" mx-change="__fK()" id="cb_<%=$$.id%>_<%=b[$$.valueKey]%>" value="<%=b[$$.valueKey]%>" name="<%=$$.id%>"><span class="_ac _fF _aa"><%=b[$$.textKey]%></span></label></div><%if(b.children){%><div id="<%=$$.id%>_<%=b[$$.valueKey]%>" class="_fx _ah" mx-view="mx-tree/branch?textKey=<%!$eu($$.textKey)%>&valueKey=<%!$eu($$.valueKey)%>&list=<%@b.children%>"></div><%}%></li><%}%>',s:"1"}]},init:function(e){this.updater.set(e)},render:function(){var e=this;e.updater.digest({id:e.id})},__gd:function(){var e,i,a=this.id;return n("#"+a+' input[name="'+a+'"]').each(function(a,t){t.indeterminate?e=i=!0:t.checked?e=!0:i=!0}),e&&i?3:e?2:1},__ge:function(e){var i=this.owner.parent(),a=0;if(i){for(var t=0,l=i.children();t<l.length;t++){var c=l[t],d=r.get(c);d&&(a|=d.invoke("__gd"))}var _=n("#cb_"+e);3===a?_.prop("indeterminate",!0):(_.prop("indeterminate",!1),_.prop("checked",2==a)),i.invoke("__ge",[i.id])}},__ch:function(e){var i=this,a=i.id;n("#"+a+' input[name="'+a+'"]').prop("indeterminate",!1).prop("checked",e);for(var t=0,l=i.owner.children();t<l.length;t++){var c=l[t],d=r.get(c);d&&d.invoke("__ch",[e])}},"__aA<click>":function(e){var i=n("#"+this.id+"_"+e.params.id),a=n(e.eventTarget).find("span");"+"==n.trim(a.html())?(i.slideDown(),a.html("-")):(i.slideUp(),a.html("+"))},"__fK<change>":function(e){var i=this,a=r.get(i.id+"_"+e.eventTarget.value);a&&a.invoke("__ch",[e.eventTarget.checked]),i.__ge(i.id)}})});