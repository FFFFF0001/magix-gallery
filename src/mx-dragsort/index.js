define("mx-dragsort/index",["magix","../mx-dragdrop/index","../mx-runner/index","$"],function(_,e,t){var i=_("magix"),o=_("../mx-dragdrop/index"),n=_("../mx-runner/index"),b=_("$");i.applyStyle("_n",'._ch{left:-1000px;top:0;background:#6363e6}._ch,._ci{position:absolute}._ci{width:26px;height:26px}._cj{background:#479b47}._ck{background:#e94f4f}._ci:after{font-size:20px;line-height:26px;color:#fff;position:absolute;left:0;right:0;top:0;bottom:0;text-align:center}._cj:after{content:"✓"}._ck:after{content:"✗"}');var r=i.guid("dbar_"),d=i.guid("pt_"),a=b(window),h=b(document),l={__bm:function(){b("#"+r).length||b('<div class="_ch" id="'+r+'"/>').appendTo("body")},__aV:function(_){_.child&&(b(_.child).css({opacity:.4}),this.__bm())},__bf:function(_){_.child&&b(_.child).css({opacity:1}),this.__bn(),this.__bo()},__bn:function(){b("#"+r).css({left:-1e5})},__bp:function(_,e){var t=b("#"+r),i=!1;2&_.anchor&&(2&e?(t.css({height:2,width:_.bound.width,top:_.bound.y-1,left:_.bound.x}),i=!0):8&e&&(t.css({height:2,width:_.bound.width,top:_.bound.y+_.bound.height-1,left:_.bound.x}),i=!0)),!i&&1&_.anchor&&(1&e?t.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x-1}):4&e&&t.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x+_.bound.width-1}))},__br:function(_){var e=this;_.atPlace&&_.child!=_.hover?(3==_.anchor?_.__bq&&e.__bp(_,_.side):_.__br&&e.__bp(_,_.position),e.__bs(!0)):(e.__bn(),e.__bs())},__bt:function(_){var e=b("#"+d);e.length||(e=b('<div class="_ci" id="'+d+'"/>')).appendTo("body");var t=Math.max(0,Math.min(_.pageX+10,h.width()-e.width())),i=Math.max(0,Math.min(_.pageY+18,h.height()-e.height()));e.css({left:t,top:i,display:"block"})},__bs:function(_){var e=b("#"+d);_?e.removeClass("_ck").addClass("_cj"):e.addClass("_ck").removeClass("_cj")},__bo:function(){b("#"+d).hide()}};t.exports=i.View.extend({init:function(_){var e=this,t=b("#"+e.id);t.on("mousedown",_.selector,function(_){_.preventDefault(),e.__aV(_)}),e.on("destroy",function(){t.off("mousedown")}),e.__i=t;var o=[t.get(0)];_.drops&&(o=o.concat(_.drops.split(","))),e.__bu=o;var n=_.horizonal+""=="true",r=_.vertical+""=="true";n||r||(r=!0);var d=0;n&&(d|=1),r&&(d|=2),e.__bv=d;var a=!0;i.has(_,"sort")&&(a=_.sort+""=="true"),e.__bw=a},__bx:function(_){for(var e=0,t=this.__bu;e<t.length;e++){var o=t[e];if(i.inside(_,o))return i.node(o)}return null},__aX:function(_,e){var t=this,i=null;if(e||(e=t.__bx(_)),!t.__bw&&t.__by)return{child:t.__by,zone:e};for(;e!=_;){if(_.parentNode==e){i=_;break}_=_.parentNode}return!e||e.firstChild||i||(i=e),i&&"false"===i.getAttribute("ds-draggable")&&(i=null),{child:i,zone:e}},__bA:function(_,e){var t=0,i=0,o=-1,n=-1,b=-1,r=-1,d=!1;if(e.pageX>=_.x&&e.pageX<=_.x+_.width&&e.pageY>=_.y&&e.pageY<=_.y+_.height&&(t|=e.pageX<=_.x+_.width/2?1:4,o=e.pageX-_.x,b=_.x+_.width-e.pageX,t|=e.pageY<=_.y+_.height/2?2:8,n=e.pageY-_.y,r=_.y+_.height-e.pageY,d=!0),d){var a=Math.min(o,n,b,r);a>-1&&(a==o?i=1:a==n?i=2:a==b?i=4:a==r&&(i=8))}var h=this.__bz;return h&&h.zone===h.hover&&(t=2,i=1),{position:t,atPlace:d,side:i}},__aV:function(_){if(1===_.which){var e=this,t=e.__aX(_.target);t.child&&(e.__by=t.child,e.__bB=t.zone,e.__i.trigger({type:"dragbegin",dragNode:t.child,dragZone:t.zone}),l.__aV(t),o.begin(t.zone,function(_){e.__be(_)},function(_){e.__bf(_)}))}},__bE:function(_,e,t){var i=this,o=i.__bA(_,e),n=o.side!=i.__bC,b=o.position!=i.__bD;(n||b)&&(i.__bC=o.side,i.__bD=o.position,t.__bq=n,t.__br=b,t.side=o.side,t.position=o.position,t.atPlace=o.atPlace,t.anchor=i.__bv,l.__br(t))},__be:function(_){var e=o.fromPoint(_.clientX,_.clientY),t=this;if(l.__bt(_),t.__bg=_,t.__aW=!0,t.__bF(),t.__bh(),t.__bG||t.__bH||!e)return delete t.__bI,delete t.__bC,void delete t.__bD;if(t.__bI!=e){if(e.id===r)return;t.__bI=e,delete t.__bC;var n=t.__bx(e);if(n){n!=t.__bJ&&(t.__bJ=n,t.__i.trigger({type:"enterzone",zone:n,changePointer:l.__bs}));var d=t.__aX(e,n);if(!d.child)return;var a=b(d.child),h=a.offset(),c={x:h.left,y:h.top,width:a.outerWidth(),height:a.outerHeight()};h=(a=b(d.zone)).offset(),t.__bK={x:h.left,y:h.top,scrollX:a.prop("scrollLeft"),scrollY:a.prop("scrollTop"),maxWidth:a.prop("scrollWidth"),maxHeight:a.prop("scrollHeight"),width:a.width(),height:a.height()},t.__bE(t.__bL=c,_,t.__bz={child:t.__by,bound:c,zone:d.zone,hover:d.child})}else t.__bJ&&(t.__i.trigger({type:"leavezone",zone:t.__bJ,changePointer:l.__bs}),delete t.__bJ)}else t.__bL&&i.inside(e,t.__bz.zone)?t.__bE(t.__bL,_,t.__bz):(delete t.__bC,delete t.__bD,t.__bw&&(l.__bn(),l.__bs()))},__bf:function(){var _=this;_.__bM(),_.__bi(),l.__bf({child:_.__by});var e=_.__bD,t=_.__bC,i=_.__aW,o=_.__bz,n=_.__by;if(i&&(e||t)){var b=o.zone,r=_.__bv,d=3===r?t:e;if(1&r&&1&d||2&d&&2&r)o.hover==b?b.appendChild(n):b.insertBefore(n,o.hover);else if(8&d&&2&r||4&d&&1&r){for(var a=o.hover.nextSibling;a&&1!=a.nodeType;)a=a.nextSibling;b.insertBefore(n,a),a||(b.scrollTop=b.scrollHeight)}}o&&_.__i.trigger({type:"dragfinish",moved:i,dragNode:n,dragZone:_.__bB,dropNode:o.hover,dropZone:o.zone,outZone:!_.__bJ}),delete _.__by,delete _.__bB,delete _.__bI,delete _.__bz,delete _.__bL,delete _.__bD,delete _.__bC,delete _.__bg,delete _.__bH,delete _.__bJ,delete _.__bK,delete _.__bG,delete _.__aW},__bF:function(){var _=this;_.__bN||(_.__bN=function(){var e=_.__bK;if(e){var t=_.__bz.zone,i=0,o=0,n=_.__bg;n.pageX>e.x&&n.pageY>e.y&&n.pageX<e.x+e.width&&n.pageY<e.y+e.height?(n.pageX-e.x<20&&e.scrollX>0?i=-Math.min(7,e.scrollX):e.x+e.width-n.pageX<20&&e.scrollX+e.width<e.maxWidth&&(i=Math.min(7,e.maxWidth-e.scrollX-e.width)),n.pageY-e.y<20&&e.scrollY>0?o=-Math.min(7,e.scrollY):e.y+e.height-n.pageY<20&&e.scrollY+e.height<e.maxHeight&&(o=Math.min(7,e.maxHeight-e.scrollY-e.height)),i||o?(_.__bG=!0,_.__bO=!0,t.scrollTop+=o,t.scrollLeft+=i,e.scrollX+=i,e.scrollY+=o,delete _.__aW,l.__bn(),l.__bs()):(delete _.__bG,delete _.__bO)):(delete _.__bG,delete _.__bO)}},n.__bk(30,_.__bN))},__bh:function(){var _=this;_.__bj||(_.__bj=function(){if(!_.__bO){var e=0,t=0,i=_.__bg,o=a.scrollTop(),n=a.height(),b=h.height(),r=h.width(),d=a.width(),c=a.scrollLeft();i.pageX-c<20&&c>0?e=-Math.min(7,c):c+d-i.pageX<20&&c+d<r&&(e=Math.min(7,r-d-c)),i.pageY-o<20&&o>0?t=-Math.min(7,o):o+n-i.pageY<20&&o+n<b&&(t=Math.min(7,b-n-o)),e||t?(_.__bH=!0,i.pageX+=e,i.pageY+=t,window.scrollBy(e,t),delete _.__aW,l.__bn(),l.__bt(i),l.__bs()):delete _.__bH}},n.__bk(30,_.__bj))},__bM:function(){var _=this;_.__bN&&(n.__bl(_.__bN),delete _.__bN,delete _.__bO)},__bi:function(){var _=this;_.__bj&&(n.__bl(_.__bj),delete _.__bj)}})});