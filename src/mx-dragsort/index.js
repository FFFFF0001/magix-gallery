define("mx-dragsort/index",["magix","../mx-dragdrop/index","../mx-runner/index","$"],function(_,e,t){var i=_("magix"),o=_("../mx-dragdrop/index"),n=_("../mx-runner/index"),a=_("$");i.applyStyle("m",'.bX{left:-1000px;top:0;background:#6363e6}.bX,.bY{position:absolute}.bY{width:26px;height:26px}.bZ{background:#479b47}.c_{background:#e94f4f}.bY:after{font-size:20px;line-height:26px;color:#fff;position:absolute;left:0;right:0;top:0;bottom:0;text-align:center}.bZ:after{content:"✓"}.c_:after{content:"✗"}');var b=i.guid("dbar_"),r=i.guid("pt_"),d=a(window),h=a(document),l={__b_:function(){a("#"+b).length||a('<div class="bX" id="'+b+'"/>').appendTo("body")},__aI:function(_){_.child&&(a(_.child).css({opacity:.4}),this.__b_())},__aT:function(_){_.child&&a(_.child).css({opacity:1}),this.__ba(),this.__bb()},__ba:function(){a("#"+b).css({left:-1e5})},__bc:function(_,e){var t=a("#"+b),i=!1;2&_.anchor&&(2&e?(t.css({height:2,width:_.bound.width,top:_.bound.y-1,left:_.bound.x}),i=!0):8&e&&(t.css({height:2,width:_.bound.width,top:_.bound.y+_.bound.height-1,left:_.bound.x}),i=!0)),!i&&1&_.anchor&&(1&e?t.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x-1}):4&e&&t.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x+_.bound.width-1}))},__be:function(_){var e=this;_.atPlace&&_.child!=_.hover?(3==_.anchor?_.__bd&&e.__bc(_,_.side):_.__be&&e.__bc(_,_.position),e.__bf(!0)):(e.__ba(),e.__bf())},__bg:function(_){var e=a("#"+r);e.length||(e=a('<div class="bY" id="'+r+'"/>')).appendTo("body");var t=Math.max(0,Math.min(_.pageX+10,h.width()-e.width())),i=Math.max(0,Math.min(_.pageY+18,h.height()-e.height()));e.css({left:t,top:i,display:"block"})},__bf:function(_){var e=a("#"+r);_?e.removeClass("c_").addClass("bZ"):e.addClass("c_").removeClass("bZ")},__bb:function(){a("#"+r).hide()}};t.exports=i.View.extend({init:function(_){var e=this,t=a("#"+e.id);t.on("mousedown",_.selector,function(_){_.preventDefault(),e.__aI(_)}),e.on("destroy",function(){t.off("mousedown")}),e.__h=t;var o=[t.get(0)];_.drops&&(o=o.concat(_.drops.split(","))),e.__bh=o;var n=_.horizonal+""=="true",b=_.vertical+""=="true";n||b||(b=!0);var r=0;n&&(r|=1),b&&(r|=2),e.__bi=r;var d=!0;i.has(_,"sort")&&(d=_.sort+""=="true"),e.__bj=d},__bk:function(_){for(var e=0,t=this.__bh;e<t.length;e++){var o=t[e];if(i.inside(_,o))return i.node(o)}return null},__aK:function(_,e){var t=this,i=null;if(e||(e=t.__bk(_)),!t.__bj&&t.__bl)return{child:t.__bl,zone:e};for(;e!=_;){if(_.parentNode==e){i=_;break}_=_.parentNode}return!e||e.firstChild||i||(i=e),i&&"false"===i.getAttribute("ds-draggable")&&(i=null),{child:i,zone:e}},__bn:function(_,e){var t=0,i=0,o=-1,n=-1,a=-1,b=-1,r=!1;if(e.pageX>=_.x&&e.pageX<=_.x+_.width&&e.pageY>=_.y&&e.pageY<=_.y+_.height&&(t|=e.pageX<=_.x+_.width/2?1:4,o=e.pageX-_.x,a=_.x+_.width-e.pageX,t|=e.pageY<=_.y+_.height/2?2:8,n=e.pageY-_.y,b=_.y+_.height-e.pageY,r=!0),r){var d=Math.min(o,n,a,b);d>-1&&(d==o?i=1:d==n?i=2:d==a?i=4:d==b&&(i=8))}var h=this.__bm;return h&&h.zone===h.hover&&(t=2,i=1),{position:t,atPlace:r,side:i}},__aI:function(_){if(1===_.which){var e=this,t=e.__aK(_.target);t.child&&(e.__bl=t.child,e.__bo=t.zone,e.__h.trigger({type:"dragbegin",dragNode:t.child,dragZone:t.zone}),l.__aI(t),o.begin(t.zone,function(_){e.__aS(_)},function(_){e.__aT(_)}))}},__br:function(_,e,t){var i=this,o=i.__bn(_,e),n=o.side!=i.__bp,a=o.position!=i.__bq;(n||a)&&(i.__bp=o.side,i.__bq=o.position,t.__bd=n,t.__be=a,t.side=o.side,t.position=o.position,t.atPlace=o.atPlace,t.anchor=i.__bi,l.__be(t))},__aS:function(_){var e=o.fromPoint(_.clientX,_.clientY),t=this;if(l.__bg(_),t.__aU=_,t.__aJ=!0,t.__bs(),t.__aV(),t.__bt||t.__bu||!e)return delete t.__bv,delete t.__bp,void delete t.__bq;if(t.__bv!=e){if(e.id===b)return;t.__bv=e,delete t.__bp;var n=t.__bk(e);if(n){n!=t.__bw&&(t.__bw=n,t.__h.trigger({type:"enterzone",zone:n,changePointer:l.__bf}));var r=t.__aK(e,n);if(!r.child)return;var d=a(r.child),h=d.offset(),s={x:h.left,y:h.top,width:d.outerWidth(),height:d.outerHeight()};h=(d=a(r.zone)).offset(),t.__bx={x:h.left,y:h.top,scrollX:d.prop("scrollLeft"),scrollY:d.prop("scrollTop"),maxWidth:d.prop("scrollWidth"),maxHeight:d.prop("scrollHeight"),width:d.width(),height:d.height()},t.__br(t.__by=s,_,t.__bm={child:t.__bl,bound:s,zone:r.zone,hover:r.child})}else t.__bw&&(t.__h.trigger({type:"leavezone",zone:t.__bw,changePointer:l.__bf}),delete t.__bw)}else t.__by&&i.inside(e,t.__bm.zone)?t.__br(t.__by,_,t.__bm):(delete t.__bp,delete t.__bq,t.__bj&&(l.__ba(),l.__bf()))},__aT:function(){var _=this;_.__bz(),_.__aW(),l.__aT({child:_.__bl});var e=_.__bq,t=_.__bp,i=_.__aJ,o=_.__bm,n=_.__bl;if(i&&(e||t)){var a=o.zone,b=_.__bi,r=3===b?t:e;if(1&b&&1&r||2&r&&2&b)o.hover==a?a.appendChild(n):a.insertBefore(n,o.hover);else if(8&r&&2&b||4&r&&1&b){for(var d=o.hover.nextSibling;d&&1!=d.nodeType;)d=d.nextSibling;a.insertBefore(n,d),d||(a.scrollTop=a.scrollHeight)}}o&&_.__h.trigger({type:"dragfinish",moved:i,dragNode:n,dragZone:_.__bo,dropNode:o.hover,dropZone:o.zone,outZone:!_.__bw}),delete _.__bl,delete _.__bo,delete _.__bv,delete _.__bm,delete _.__by,delete _.__bq,delete _.__bp,delete _.__aU,delete _.__bu,delete _.__bw,delete _.__bx,delete _.__bt,delete _.__aJ},__bs:function(){var _=this;_.__bA||(_.__bA=function(){var e=_.__bx;if(e){var t=_.__bm.zone,i=0,o=0,n=_.__aU;n.pageX>e.x&&n.pageY>e.y&&n.pageX<e.x+e.width&&n.pageY<e.y+e.height?(n.pageX-e.x<20&&e.scrollX>0?i=-Math.min(7,e.scrollX):e.x+e.width-n.pageX<20&&e.scrollX+e.width<e.maxWidth&&(i=Math.min(7,e.maxWidth-e.scrollX-e.width)),n.pageY-e.y<20&&e.scrollY>0?o=-Math.min(7,e.scrollY):e.y+e.height-n.pageY<20&&e.scrollY+e.height<e.maxHeight&&(o=Math.min(7,e.maxHeight-e.scrollY-e.height)),i||o?(_.__bt=!0,_.__bB=!0,t.scrollTop+=o,t.scrollLeft+=i,e.scrollX+=i,e.scrollY+=o,delete _.__aJ,l.__ba(),l.__bf()):(delete _.__bt,delete _.__bB)):(delete _.__bt,delete _.__bB)}},n.__aY(30,_.__bA))},__aV:function(){var _=this;_.__aX||(_.__aX=function(){if(!_.__bB){var e=0,t=0,i=_.__aU,o=d.scrollTop(),n=d.height(),a=h.height(),b=h.width(),r=d.width(),s=d.scrollLeft();i.pageX-s<20&&s>0?e=-Math.min(7,s):s+r-i.pageX<20&&s+r<b&&(e=Math.min(7,b-r-s)),i.pageY-o<20&&o>0?t=-Math.min(7,o):o+n-i.pageY<20&&o+n<a&&(t=Math.min(7,a-n-o)),e||t?(_.__bu=!0,i.pageX+=e,i.pageY+=t,window.scrollBy(e,t),delete _.__aJ,l.__ba(),l.__bg(i),l.__bf()):delete _.__bu}},n.__aY(30,_.__aX))},__bz:function(){var _=this;_.__bA&&(n.__aZ(_.__bA),delete _.__bA,delete _.__bB)},__aW:function(){var _=this;_.__aX&&(n.__aZ(_.__aX),delete _.__aX)}})});