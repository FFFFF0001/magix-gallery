define("mx-dragsort/index",["magix","../mx-dragdrop/index","../mx-runner/index","$"],(e,_,t)=>{let i=e("magix"),l=e("../mx-dragdrop/index"),o=e("../mx-runner/index"),b=e("$");i.applyStyle("_n",'._cg{left:-1000px;top:0;background:#f96447}._cg,._ch{position:absolute}._ch{width:26px;height:26px}._ci{background:#479b47}._cj{background:#e94f4f}._ch:after{font-size:20px;line-height:26px;color:#fff;position:absolute;left:0;right:0;top:0;bottom:0;text-align:center}._ci:after{content:"✓"}._cj:after{content:"✗"}');let d=i.guid("dbar_"),h=i.guid("pt_"),n=b(window),r=b(document),a={__bi(){b("#"+d).length||b('<div class="_cg" id="'+d+'"/>').appendTo("body")},__aR(e){e.child&&(b(e.child).css({opacity:.4}),this.__bi())},__bb(e){e.child&&b(e.child).css({opacity:1}),this.__bj(),this.__bk()},__bj(){b("#"+d).css({left:-1e5})},__bl(e,_){let t=b("#"+d),i=!1;2&e.anchor&&(2&_?(t.css({height:2,width:e.bound.width,top:e.bound.y-1,left:e.bound.x}),i=!0):8&_&&(t.css({height:2,width:e.bound.width,top:e.bound.y+e.bound.height-1,left:e.bound.x}),i=!0)),!i&&1&e.anchor&&(1&_?t.css({height:e.bound.height,width:2,top:e.bound.y,left:e.bound.x-1}):4&_&&t.css({height:e.bound.height,width:2,top:e.bound.y,left:e.bound.x+e.bound.width-1}))},__bn(e){let _=this;e.atPlace&&e.child!=e.hover?(3==e.anchor?e.__bm&&_.__bl(e,e.side):e.__bn&&_.__bl(e,e.position),_.__bo(!0)):(_.__bj(),_.__bo())},__bp(e){let _=b("#"+h);_.length||(_=b('<div class="_ch" id="'+h+'"/>')).appendTo("body");let t=Math.max(0,Math.min(e.pageX+10,r.width()-_.width())),i=Math.max(0,Math.min(e.pageY+18,r.height()-_.height()));_.css({left:t,top:i,display:"block"})},__bo(e){let _=b("#"+h);e?_.removeClass("_cj").addClass("_ci"):_.addClass("_cj").removeClass("_ci")},__bk(){b("#"+h).hide()}};t.exports=i.View.extend({init(e){let _=this,t=b("#"+_.id);t.on("mousedown",e.selector,e=>{e.preventDefault(),_.__aR(e)}),_.on("destroy",()=>{t.off("mousedown")}),_.__h=t;let l=[t.get(0)];e.drops&&(l=l.concat(e.drops.split(","))),_.__bq=l;let o=e.horizonal+""=="true",d=e.vertical+""=="true";o||d||(d=!0);let h=0;o&&(h|=1),d&&(h|=2),_.__br=h;let n=!0;i.has(e,"sort")&&(n=e.sort+""=="true"),_.__bs=n},__bt(e){let _=this.__bq;for(let t of _)if(i.inside(e,t))return i.node(t);return null},__aT(e,_){let t=this,i=null;if(_||(_=t.__bt(e)),!t.__bs&&t.__bu)return{child:t.__bu,zone:_};for(;_!=e;){if(e.parentNode==_){i=e;break}e=e.parentNode}return!_||_.firstChild||i||(i=_),i&&"false"===i.getAttribute("ds-draggable")&&(i=null),{child:i,zone:_}},__bw(e,_){let t=0,i=0,l=-1,o=-1,b=-1,d=-1,h=!1;if(_.pageX>=e.x&&_.pageX<=e.x+e.width&&_.pageY>=e.y&&_.pageY<=e.y+e.height&&(t|=_.pageX<=e.x+e.width/2?1:4,l=_.pageX-e.x,b=e.x+e.width-_.pageX,t|=_.pageY<=e.y+e.height/2?2:8,o=_.pageY-e.y,d=e.y+e.height-_.pageY,h=!0),h){var n=Math.min(l,o,b,d);n>-1&&(n==l?i=1:n==o?i=2:n==b?i=4:n==d&&(i=8))}let r=this.__bv;return r&&r.zone===r.hover&&(t=2,i=1),{position:t,atPlace:h,side:i}},__aR(e){if(1===e.which){let _=this,t=_.__aT(e.target);t.child&&(_.__bu=t.child,_.__bx=t.zone,_.__h.trigger({type:"dragbegin",dragNode:t.child,dragZone:t.zone}),a.__aR(t),l.begin(t.zone,e=>{_.__ba(e)},e=>{_.__bb(e)}))}},__bA(e,_,t){let i=this,l=i.__bw(e,_),o=l.side!=i.__by,b=l.position!=i.__bz;(o||b)&&(i.__by=l.side,i.__bz=l.position,t.__bm=o,t.__bn=b,t.side=l.side,t.position=l.position,t.atPlace=l.atPlace,t.anchor=i.__br,a.__bn(t))},__ba(e){let _=l.fromPoint(e.clientX,e.clientY),t=this;if(a.__bp(e),t.__bc=e,t.__aS=!0,t.__bB(),t.__bd(),t.__bC||t.__bD||!_)return delete t.__bE,delete t.__by,void delete t.__bz;if(t.__bE!=_){if(_.id===d)return;t.__bE=_,delete t.__by;let i=t.__bt(_);if(i){i!=t.__bF&&(t.__bF=i,t.__h.trigger({type:"enterzone",zone:i,changePointer:a.__bo}));let l=t.__aT(_,i);if(!l.child)return;let o=b(l.child),d=o.offset(),h={x:d.left,y:d.top,width:o.outerWidth(),height:o.outerHeight()};d=(o=b(l.zone)).offset(),t.__bG={x:d.left,y:d.top,scrollX:o.prop("scrollLeft"),scrollY:o.prop("scrollTop"),maxWidth:o.prop("scrollWidth"),maxHeight:o.prop("scrollHeight"),width:o.width(),height:o.height()},t.__bA(t.__bH=h,e,t.__bv={child:t.__bu,bound:h,zone:l.zone,hover:l.child})}else t.__bF&&(t.__h.trigger({type:"leavezone",zone:t.__bF,changePointer:a.__bo}),delete t.__bF)}else t.__bH&&i.inside(_,t.__bv.zone)?t.__bA(t.__bH,e,t.__bv):(delete t.__by,delete t.__bz,t.__bs&&(a.__bj(),a.__bo()))},__bb(){let e=this;e.__bI(),e.__be(),a.__bb({child:e.__bu});let _=e.__bz,t=e.__by,i=e.__aS,l=e.__bv,o=e.__bu;if(i&&(_||t)){let i=l.zone,b=e.__br,d=3===b?t:_;if(1&b&&1&d||2&d&&2&b)l.hover==i?i.appendChild(o):i.insertBefore(o,l.hover);else if(8&d&&2&b||4&d&&1&b){let e=l.hover.nextSibling;for(;e&&1!=e.nodeType;)e=e.nextSibling;i.insertBefore(o,e),e||(i.scrollTop=i.scrollHeight)}}l&&e.__h.trigger({type:"dragfinish",moved:i,dragNode:o,dragZone:e.__bx,dropNode:l.hover,dropZone:l.zone,outZone:!e.__bF}),delete e.__bu,delete e.__bx,delete e.__bE,delete e.__bv,delete e.__bH,delete e.__bz,delete e.__by,delete e.__bc,delete e.__bD,delete e.__bF,delete e.__bG,delete e.__bC,delete e.__aS},__bB(){let e=this;e.__bJ||(e.__bJ=(()=>{let _=e.__bG;if(_){let t=e.__bv.zone,i=0,l=0,o=e.__bc;o.pageX>_.x&&o.pageY>_.y&&o.pageX<_.x+_.width&&o.pageY<_.y+_.height?(o.pageX-_.x<20&&_.scrollX>0?i=-Math.min(7,_.scrollX):_.x+_.width-o.pageX<20&&_.scrollX+_.width<_.maxWidth&&(i=Math.min(7,_.maxWidth-_.scrollX-_.width)),o.pageY-_.y<20&&_.scrollY>0?l=-Math.min(7,_.scrollY):_.y+_.height-o.pageY<20&&_.scrollY+_.height<_.maxHeight&&(l=Math.min(7,_.maxHeight-_.scrollY-_.height)),i||l?(e.__bC=!0,e.__bK=!0,t.scrollTop+=l,t.scrollLeft+=i,_.scrollX+=i,_.scrollY+=l,delete e.__aS,a.__bj(),a.__bo()):(delete e.__bC,delete e.__bK)):(delete e.__bC,delete e.__bK)}}),o.__bg(30,e.__bJ))},__bd(){let e=this;e.__bf||(e.__bf=(()=>{if(e.__bK)return;let _=0,t=0,i=e.__bc,l=n.scrollTop(),o=n.height(),b=r.height(),d=r.width(),h=n.width(),s=n.scrollLeft();i.pageX-s<20&&s>0?_=-Math.min(7,s):s+h-i.pageX<20&&s+h<d&&(_=Math.min(7,d-h-s)),i.pageY-l<20&&l>0?t=-Math.min(7,l):l+o-i.pageY<20&&l+o<b&&(t=Math.min(7,b-o-l)),_||t?(e.__bD=!0,i.pageX+=_,i.pageY+=t,window.scrollBy(_,t),delete e.__aS,a.__bj(),a.__bp(i),a.__bo()):delete e.__bD}),o.__bg(30,e.__bf))},__bI(){let e=this;e.__bJ&&(o.__bh(e.__bJ),delete e.__bJ,delete e.__bK)},__be(){let e=this;e.__bf&&(o.__bh(e.__bf),delete e.__bf)}})});