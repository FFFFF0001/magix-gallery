define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],function(e,t,i){var _=e("magix"),s=e("$"),a=e("../mx-monitor/index");_.applyStyle("_p","._cz{position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cz:hover{border-color:#ccc}._cA{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cB{cursor:not-allowed;background-color:#fbfbfb}._cB:hover{border-color:#e6e6e6}._cB ._cA{cursor:not-allowed}._cC{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cD ._cC{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cD,._cD:hover{border-color:#6363e6}._cE{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cF{color:#999}._cG{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cD ._cG{display:block}._cH{overflow:auto;max-height:192px;padding:4px 0}._cI{display:block;width:100%;padding:9px 9px 4px}._cJ{padding:0;width:100%}._cK{color:#ccc;position:absolute;left:15px;top:18px}._cL{padding-left:28px;width:100%;height:28px;line-height:28px}._cM{padding:5px;color:#999;display:block;cursor:default}._cN{padding:3px 4px}._cO{color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cP{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cQ{color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cO:hover,._cQ:hover{color:#333;background-color:#f0f0f0}._cR,._cR:active,._cR:focus,._cR:hover{color:#fff;background-color:#6363e6}._cS{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._cT{border-left:1px solid #e6e6e6}");var r=function(e,t,i,s,a){if(!e[t]||_.has(i,s)){var r=i[s]||"";a||(r+=""),e[t]=r}return e[t]};i.exports=_.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cA" mx-click="__aq()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cE<%if($$.phLabel){%> _cF<%}%>">2</span><span class="__ _cC">&#xe692;</span></div><div mx-guid="g2" class="_cG">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["phLabel","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:'class="_cE<%if($$.phLabel){%> _cF<%}%>"',attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_cI"><label class="_cJ"><span class="__ _cK">&#xe608;</span><input mx-keyup="__bP()" mx-paste="__bP()" mx-change="__bR()" mx-focusin="__bR()" mx-focusout="__bR()" placeholder="搜索关键词" class="_ao _cL"></label></div><%}%><ul mx-guid="g3" class="_cH" id="list_<%=$$.viewId%>">4</ul><div class="_cS _ah"><div class="_a_"><button type="button" class="_am _an" mx-click="__a({enter:true})">确定</button><button type="button" class="_am _s" mx-click="__a()">取消</button></div><div class="_a_ _t _cT _R"><button type="button" class="_am" mx-click="__bY()">全选/不选</button><button type="button" class="_am _s" mx-click="__bZ()">反选</button></div></div><%}%>',s:"3"},{keys:["selected","list","textKey","valueKey","emptyText"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var a=$$.selected.split(\',\'),b=void 0,c=void 0;for(var d=0;d<$$.list.length;d++){var e=$$.list[d];if(e&&e.group){%><li class="_cM _ak" title="<%=e[$$.textKey]%>"><%=e[$$.textKey]%></li><%}else{if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}if($$.emptyText===c&&d===0){c=\'\';e=\'\';}var f=$$.inArray(c+\'\',a)>-1;if(c===\'\'){%><li title="<%=b%>" class="_cN"><a href="#" class="_cO _ak <%if(f){%> _cR<%}%>" mx-click="__bQ({item:\'<%@e%>\'})"><%=b%></a></li><%}else{%><li class="_cN _ah"><ul><%for(;d<$$.list.length;d++){e=$$.list[d];if(e&&e.group){d--;break;}if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}var g=$$.inArray(c+\'\',a)>-1%><li class="_cP"><a href="#" class="_cQ _ak<%if(g){%> _cR<%}%>" mx-click="__bQ({item:\'<%@e%>\'})"><%=b%></a></li><%}%></ul></li><%}}}%>',s:"4"}]},init:function(e){var t=this;a.__d(),t.on("destroy",function(){a.__f(t),a.__g()}),t.updater.set({viewId:t.id,inArray:s.inArray});var i=s("#"+t.id);t.__h=i,i.addClass("_cz"),t.assign(e)},assign:function(e){var t=this;r(t,"__bE",e,"list",1);var i=r(t,"__au",e,"selected"),a=r(t,"__bF",e,"textKey"),c=r(t,"__bG",e,"valueKey"),o=r(t,"__bH",e,"emptyText");if(t.__bI=e.searchbox+""=="true",t.__bS=e.disabled+""=="true",!t.__bE){var l,n=[];t.__h.children().each(function(e,t){t=s(t),l="true"==t.attr("group"),n.push({group:l,text:t.text(),value:l?_.guid():t.attr("value")})}),a=t.__bF="text",c=t.__bG="value",t.__bE=n}var d=t.__bE,p=_.toMap(d,c);if(o)if(a&&c){if(!p[""]){var u={};u[a]=o,u[c]="",d.unshift(u),p[""]=u}}else p[o]||(d.unshift(o),p[""]=o);return t.__au=i,t.__bT=p,t.updater.set({list:d}),!0},__i:function(e){var t=this;return _.inside(e,t.id)},render:function(){var e=this;e.__h[e.__bS?"addClass":"removeClass"]("_cB"),e.__bU(e.__au)},__a:function(e){var t=this;if(t.__h.hasClass("_cD")){var i=t.updater.get();if(_.has(t,"__bV")){var s=e&&i.selected!==t.__bV;e?t.__bU(i.selected):t.__bU(t.__bV),s&&t.__h.val(i.selected).trigger({type:"change",keys:{text:i.textKey,value:i.valueKey},values:(i.selected+"").split(",")}),delete t.__bV}t.__h.removeClass("_cD").trigger("focusout"),a.__f(t)}},__e:function(){var e=this;if(!e.__h.hasClass("_cD")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("_cD").trigger("focusin");var t=s("#list_"+e.id),i=t.find("._cR").position();if(i){var _=t.height(),r=t.prop("scrollTop");if(i.top<0||i.top>_){var c=i.top-_+r+_/2;t.prop("scrollTop",c)}}a.__k(e)}},__bW:function(e,t){for(var i=this.__bT,_=[],s=0,a=e;s<a.length;s++){var r=a[s],c=i[r]||{};t?_.push(c[t]):_.push(r||c)}return _},__bU:function(e){var t=this;e=e||"",e+="";var i=t.__bF||"",_=t.__bG||"",s=e.split(","),a="",r=t.__bE;s.length?a=t.__bW(s,i):(e=r[0],a=r[0],i&&_&&(a=(e=e[_])[i])),t.updater.digest({textKey:i,valueKey:_,emptyText:t.__bH,searchbox:t.__bI,phLabel:""===e,selected:t.__au=e,selectedText:a}),t.__h.val(e)},__bN:function(e,t){var i=this;clearTimeout(i.__bM);var _=i.__bE,s=[],a=0,r=_.length,c=i.__bF,o=i.__bG;if(e){var l=function(){if(a<r){for(var n=Math.min(a+400,r),d=a,p=void 0,u=void 0,b=void 0;d<n;d++)u=p=_[d],b=p,c&&o&&(u=p[c],b=p[o]),((u+"").indexOf(e)>=0||(b+"").indexOf(e)>=0)&&s.push(p);a=n,i.__bM=setTimeout(i.wrapAsync(l),20)}else t(s)};l()}else t(_)},"__aq<click>":function(){var e=this,t=e.__h;t.hasClass("_cD")?e.__a():t.hasClass("_cB")||e.__e()},"__bP<keyup,paste>":function(e){var t=this;clearTimeout(t.__bO);var i=s.trim(e.eventTarget.value);t.__bO=setTimeout(t.wrapAsync(function(){i!=t.__bX&&t.__bN(t.__bX=i,function(e){t.updater.digest({list:e})})}),300)},"__bQ<click>":function(e){e.preventDefault();var t=this,i=e.params.item,a=t.updater,r=a.get();_.has(t,"__bV")||(t.__bV=r.selected);var c=t.__bG,o=t.__bF,l=i;o&&c&&(i[o],l=i[c]);var n=[""];l&&(n=r.selected.split(","));var d=s.inArray("",n);d>-1&&n.splice(d,1),-1==(d=s.inArray(l+"",n))?n.push(l):n.splice(d,1),n.length||r.emptyText&&(n=[""]),l=n.join(","),a.digest({selected:t.__au=l})},"__bR<change,focusin,focusout>":function(e){e.stopPropagation()},"__a<click>":function(e){this.__a(e.params.enter)},"__bY<click>":function(){var e=this,t=e.__au,i=e.__bE,s=e.__bG,a=e.updater;if(_.has(e,"__bV")||(e.__bV=t),t)t="";else{t="";for(var r=e.__bH?1:0,c=void 0;r<i.length;r++)c=i[r],s?c.group||(t+=c[s]+","):t+=c+",";t=t.slice(0,-1)}a.digest({selected:e.__au=t})},"__bZ<click>":function(){var e=this,t=e.__au,i=e.__bE,a=e.__bG,r=e.updater;_.has(e,"__bV")||(e.__bV=t);var c=t.split(",");t="";for(var o=e.__bH?1:0,l=void 0;o<i.length;o++)l=i[o],a?l.group||-1!=s.inArray(l[a]+"",c)||(t+=l[a]+","):-1==s.inArray(l+"",c)&&(t+=l+",");t=t.slice(0,-1),r.digest({selected:e.__au=t})}})});