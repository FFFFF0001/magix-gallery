define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],function(e,t,i){var _=e("magix"),a=e("$"),s=e("../mx-monitor/index");_.applyStyle("_p","._cC{position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cC:hover{border-color:#ccc}._cD{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cE{cursor:not-allowed;background-color:#fbfbfb}._cE:hover{border-color:#e6e6e6}._cE ._cD{cursor:not-allowed}._cF{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cG ._cF{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cG,._cG:hover{border-color:#6363e6}._cH{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cI{color:#999}._cJ{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cG ._cJ{display:block}._cK{overflow:auto;max-height:192px;padding:4px 0}._cL{display:block;width:100%;padding:9px 9px 4px}._cM{padding:0;width:100%}._cN{color:#ccc;position:absolute;left:15px;top:18px}._cO{padding-left:28px;width:100%;height:28px;line-height:28px}._cP{padding:5px;color:#999;display:block;cursor:default}._cQ{padding:3px 4px}._cR{color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cS{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cT{color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cR:hover,._cT:hover{color:#333;background-color:#f0f0f0}._cU,._cU:active,._cU:focus,._cU:hover{color:#fff;background-color:#6363e6}._cV{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._cW{border-left:1px solid #e6e6e6}");var c=function(e,t,i,a,s){if(!e[t]||_.has(i,a)){var c=i[a]||"";s||(c+=""),e[t]=c}return e[t]};i.exports=_.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cD" mx-click="__aA()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cH<%if($$.phLabel){%> _cI<%}%>">2</span><span class="__ _cF">&#xe692;</span></div><div mx-guid="g2" class="_cJ">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["phLabel","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:'class="_cH<%if($$.phLabel){%> _cI<%}%>"',attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_cL"><label class="_cM"><span class="__ _cN">&#xe608;</span><input mx-keyup="__bZ()" mx-paste="__bZ()" mx-change="__ca()" mx-focusin="__ca()" mx-focusout="__ca()" placeholder="搜索关键词" class="_ap _cO"></label></div><%}%><ul mx-guid="g3" class="_cK" id="list_<%=$$.viewId%>">4</ul><div class="_cV _ai"><div class="_aa"><button type="button" class="_an _ao" mx-click="__a({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__a()">取消</button></div><div class="_aa _t _cW _R"><button type="button" class="_an" mx-click="__ch()">全选/不选</button><button type="button" class="_an _s" mx-click="__ci()">反选</button></div></div><%}%>',s:"3"},{keys:["selected","list","textKey","valueKey","emptyText"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var a=$$.selected.split(\',\'),b=void 0,c=void 0;for(var d=0;d<$$.list.length;d++){var e=$$.list[d];if(e&&e.group){%><li class="_cP _al" title="<%=e[$$.textKey]%>"><%=e[$$.textKey]%></li><%}else{if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}if($$.emptyText===c&&d===0){c=\'\';e=\'\';}var f=$$.inArray(c+\'\',a)>-1;if(c===\'\'){%><li title="<%=b%>" class="_cQ"><a href="#" class="_cR _al <%if(f){%> _cU<%}%>" mx-click="__c_({item:\'<%@e%>\'})"><%=b%></a></li><%}else{%><li class="_cQ _ai"><ul><%for(;d<$$.list.length;d++){e=$$.list[d];if(e&&e.group){d--;break;}if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}var g=$$.inArray(c+\'\',a)>-1%><li class="_cS"><a href="#" class="_cT _al<%if(g){%> _cU<%}%>" mx-click="__c_({item:\'<%@e%>\'})"><%=b%></a></li><%}%></ul></li><%}}}%>',s:"4"}]},init:function(e){var t=this;s.__d(),t.on("destroy",function(){s.__f(t),s.__g()}),t.updater.set({viewId:t.id,inArray:a.inArray});var i=a("#"+t.id);t.__h=i,i.addClass("_cC"),t.assign(e)},assign:function(e){var t=this;c(t,"__bO",e,"list",1);var i=c(t,"__aE",e,"selected"),s=c(t,"__bP",e,"textKey"),r=c(t,"__bQ",e,"valueKey"),l=c(t,"__bR",e,"emptyText");if(t.__bS=e.searchbox+""=="true",t.__cb=e.disabled+""=="true",!t.__bO){var o,n=[];t.__h.children().each(function(e,t){t=a(t),o="true"==t.attr("group"),n.push({group:o,text:t.text(),value:o?_.guid():t.attr("value")})}),s=t.__bP="text",r=t.__bQ="value",t.__bO=n}var d=t.__bO,p=_.toMap(d,r);if(l)if(s&&r){if(!p[""]){var u={};u[s]=l,u[r]="",d.unshift(u),p[""]=u}}else p[l]||(d.unshift(l),p[""]=l);return t.__aE=i,t.__cc=p,t.updater.set({list:d}),!0},__i:function(e){var t=this;return _.inside(e,t.id)},render:function(){var e=this;e.__h[e.__cb?"addClass":"removeClass"]("_cE"),e.__cd(e.__aE)},__a:function(e){var t=this;if(t.__h.hasClass("_cG")){var i=t.updater.get();if(_.has(t,"__ce")){var a=e&&i.selected!==t.__ce;e?t.__cd(i.selected):t.__cd(t.__ce),a&&t.__h.val(i.selected).trigger({type:"change",keys:{text:i.textKey,value:i.valueKey},values:(i.selected+"").split(",")}),delete t.__ce}t.__h.removeClass("_cG").trigger("focusout"),s.__f(t)}},__e:function(){var e=this;if(!e.__h.hasClass("_cG")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("_cG").trigger("focusin");var t=a("#list_"+e.id),i=t.find("._cU").position();if(i){var _=t.height(),c=t.prop("scrollTop");if(i.top<0||i.top>_){var r=i.top-_+c+_/2;t.prop("scrollTop",r)}}s.__k(e)}},__cf:function(e,t){for(var i=this.__cc,_=[],a=0,s=e;a<s.length;a++){var c=s[a],r=i[c]||{};t?_.push(r[t]):_.push(c||r)}return _},__cd:function(e){var t=this;e=e||"",e+="";var i=t.__bP||"",_=t.__bQ||"",a=e.split(","),s="",c=t.__bO;a.length?s=t.__cf(a,i):(e=c[0],s=c[0],i&&_&&(s=(e=e[_])[i])),t.updater.digest({textKey:i,valueKey:_,emptyText:t.__bR,searchbox:t.__bS,phLabel:""===e,selected:t.__aE=e,selectedText:s}),t.__h.val(e)},__bX:function(e,t){var i=this;clearTimeout(i.__bW);var _=i.__bO,a=[],s=0,c=_.length,r=i.__bP,l=i.__bQ;if(e){var o=function(){if(s<c){for(var n=Math.min(s+400,c),d=s,p=void 0,u=void 0,h=void 0;d<n;d++)u=p=_[d],h=p,r&&l&&(u=p[r],h=p[l]),((u+"").indexOf(e)>=0||(h+"").indexOf(e)>=0)&&a.push(p);s=n,i.__bW=setTimeout(i.wrapAsync(o),20)}else t(a)};o()}else t(_)},"__aA<click>":function(){var e=this,t=e.__h;t.hasClass("_cG")?e.__a():t.hasClass("_cE")||e.__e()},"__bZ<keyup,paste>":function(e){var t=this;clearTimeout(t.__bY);var i=a.trim(e.eventTarget.value);t.__bY=setTimeout(t.wrapAsync(function(){i!=t.__cg&&t.__bX(t.__cg=i,function(e){t.updater.digest({list:e})})}),300)},"__c_<click>":function(e){e.preventDefault();var t=this,i=e.params.item,s=t.updater,c=s.get();_.has(t,"__ce")||(t.__ce=c.selected);var r=t.__bQ,l=t.__bP,o=i;l&&r&&(i[l],o=i[r]);var n=[""];o&&(n=c.selected.split(","));var d=a.inArray("",n);d>-1&&n.splice(d,1),-1==(d=a.inArray(o+"",n))?n.push(o):n.splice(d,1),n.length||c.emptyText&&(n=[""]),o=n.join(","),s.digest({selected:t.__aE=o})},"__ca<change,focusin,focusout>":function(e){e.stopPropagation()},"__a<click>":function(e){this.__a(e.params.enter)},"__ch<click>":function(){var e=this,t=e.__aE,i=e.__bO,a=e.__bQ,s=e.updater;if(_.has(e,"__ce")||(e.__ce=t),t)t="";else{t="";for(var c=e.__bR?1:0,r=void 0;c<i.length;c++)r=i[c],a?r.group||(t+=r[a]+","):t+=r+",";t=t.slice(0,-1)}s.digest({selected:e.__aE=t})},"__ci<click>":function(){var e=this,t=e.__aE,i=e.__bO,s=e.__bQ,c=e.updater;_.has(e,"__ce")||(e.__ce=t);var r=t.split(",");t="";for(var l=e.__bR?1:0,o=void 0;l<i.length;l++)o=i[l],s?o.group||-1!=a.inArray(o[s]+"",r)||(t+=o[s]+","):-1==a.inArray(o+"",r)&&(t+=o+",");t=t.slice(0,-1),c.digest({selected:e.__aE=t})}})});