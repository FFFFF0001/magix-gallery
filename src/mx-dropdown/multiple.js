define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],(e,t,_)=>{let s=e("magix"),i=e("$"),l=e("../mx-monitor/index");s.applyStyle("_p","._cB{outline:0;position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cB:hover{border-color:#ccc}._cC{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cD{cursor:not-allowed;background-color:#fbfbfb}._cD:hover{border-color:#e6e6e6}._cD ._cC{cursor:not-allowed}._cE{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cF ._cE{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cB:focus,._cF,._cF:hover{border-color:#f96447}._cG{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cH{color:#999}._cI{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cF ._cI{display:block}._cJ{overflow:auto;max-height:192px;padding:4px 0}._cK{display:block;width:100%;padding:9px 9px 4px}._cL{padding:0;width:100%}._cM{color:#ccc;position:absolute;left:15px;top:18px}._cN{padding-left:28px;width:100%;height:28px;line-height:28px}._cO{padding:5px;color:#999;display:block;cursor:default}._cP{padding:3px 4px}._cQ{cursor:pointer;color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cR{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cS{cursor:pointer;color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cQ:hover,._cS:hover{color:#333;background-color:#f0f0f0}._cT,._cT:active,._cT:focus,._cT:hover{color:#fff;background-color:#f96447}._cU{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._cV{border-left:1px solid #e6e6e6}");let c=(e,t,_,i,l)=>{if(!e[t]||s.has(_,i)){let s=_[i]||"";l||(s+=""),e[t]=s}return e[t]};_.exports=s.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cC" mx-click="__ax()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cG<%if($$.phLabel){%> _cH<%}%>">2</span><span class="__ _cE">&#xe692;</span></div><div mx-guid="g2" class="_cI">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["phLabel","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:'class="_cG<%if($$.phLabel){%> _cH<%}%>"',attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_cK"><label class="_cL"><span class="__ _cM">&#xe608;</span><input mx-keyup="__bW()" mx-paste="__bW()" mx-change="__bY()" mx-focusin="__bY()" mx-focusout="__bY()" placeholder="搜索关键词" class="_ap _cN"></label></div><%}%><ul mx-guid="g3" class="_cJ" id="list_<%=$$.viewId%>">4</ul><div class="_cU _ai"><div class="_aa"><button type="button" class="_an _ao" mx-click="__a({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__a()">取消</button></div><div class="_aa _t _cV _R"><button type="button" class="_an" mx-click="__ce()">全选/不选</button><button type="button" class="_an _s" mx-click="__cf()">反选</button></div></div><%}%>',s:"3"},{keys:["selected","list","textKey","valueKey","emptyText"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var _=$$.selected.split(\',\'),a=void 0,b=void 0;for(var c=0;c<$$.list.length;c++){var d=$$.list[c];if(d&&d.group){%><li class="_cO _al" title="<%=d[$$.textKey]%>"><%=d[$$.textKey]%></li><%}else{if($$.textKey&&$$.valueKey){a=d[$$.textKey];b=d[$$.valueKey];}else{a=d;b=d;}if($$.emptyText===b&&c===0){b=\'\';d=\'\';}var e=$$.inArray(b+\'\',_)>-1;if(b===\'\'){%><li title="<%=a%>" class="_cP"><span class="_cQ _al <%if(e){%> _cT<%}%>" mx-click="__bX({item:\'<%@d%>\'})"><%=a%></span></li><%}else{%><li class="_cP _ai"><ul><%for(;c<$$.list.length;c++){d=$$.list[c];if(d&&d.group){c--;break;}if($$.textKey&&$$.valueKey){a=d[$$.textKey];b=d[$$.valueKey];}else{a=d;b=d;}var f=$$.inArray(b+\'\',_)>-1%><li class="_cR"><span class="_cS _al<%if(f){%> _cT<%}%>" mx-click="__bX({item:\'<%@d%>\'})"><%=a%></span></li><%}%></ul></li><%}}}%>',s:"4"}]},init(e){let t=this;l.__d();let _=i("#"+t.id);t.__h=_,_.addClass("_cB"),_.on("keydown",e=>{13==e.keyCode&&t["__ax<click>"]()}),t.on("destroy",()=>{_.off("keydown"),l.__f(t),l.__g()}),t.updater.set({viewId:t.id,inArray:i.inArray}),t.assign(e)},assign(e){let t=this;c(t,"__bL",e,"list",1);let _=c(t,"__aB",e,"selected"),l=c(t,"__bM",e,"textKey"),a=c(t,"__bN",e,"valueKey"),o=c(t,"__bO",e,"emptyText");if(t.__bP=e.searchbox+""=="true",t.__bZ=e.disabled+""=="true",!t.__bL){let e,_=[];t.__h.children().each((t,l)=>{l=i(l),e="true"==l.attr("group"),_.push({group:e,text:l.text(),value:e?s.guid():l.attr("value")})}),l=t.__bM="text",a=t.__bN="value",t.__bL=_}let r=t.__bL,d=s.toMap(r,a);if(o)if(l&&a){if(!d[""]){let e={};e[l]=o,e[a]="",r.unshift(e),d[""]=e}}else d[o]||(r.unshift(o),d[""]=o);return t.__aB=_,t.__c_=d,t.updater.set({list:r}),!0},__i(e){return s.inside(e,this.id)},render(){let e=this;e.__h[e.__bZ?"addClass":"removeClass"]("_cD").prop("tabindex",e.__bQ?-1:0),e.__ca(e.__aB)},__a(e){let t=this;if(t.__h.hasClass("_cF")){let _=t.updater.get();if(s.has(t,"__cb")){let s=e&&_.selected!==t.__cb;e?t.__ca(_.selected):t.__ca(t.__cb),s&&t.__h.val(_.selected).trigger({type:"change",keys:{text:_.textKey,value:_.valueKey},values:(_.selected+"").split(",")}),delete t.__cb}t.__h.removeClass("_cF").trigger("focusout"),l.__f(t)}},__e(){let e=this;if(!e.__h.hasClass("_cF")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("_cF").trigger("focusin");let t=i("#list_"+e.id),_=t.find("._cT").position();if(_){let e=t.height(),s=t.prop("scrollTop");if(_.top<0||_.top>e){let i=_.top-e+s+e/2;t.prop("scrollTop",i)}}l.__k(e)}},__cc(e,t){let _=this.__c_,s=[];for(let i of e){let e=_[i]||{};t?s.push(e[t]):s.push(i||e)}return s},__ca(e){let t=this;e=e||"",e+="";let _=t.__bM||"",s=t.__bN||"",i=e.split(","),l="",c=t.__bL;i.length?l=t.__cc(i,_):(e=c[0],l=c[0],_&&s&&(l=(e=e[s])[_])),t.updater.digest({textKey:_,valueKey:s,emptyText:t.__bO,searchbox:t.__bP,phLabel:""===e,selected:t.__aB=e,selectedText:l}),t.__h.val(e)},__bU(e,t){let _=this;clearTimeout(_.__bT);let s=_.__bL,i=[],l=0,c=s.length,a=_.__bM,o=_.__bN;if(!e)return void t(s);let r=()=>{if(l<c){let t=Math.min(l+400,c);for(let _,c,r,d=l;d<t;d++)c=_=s[d],r=_,a&&o&&(c=_[a],r=_[o]),((c+"").indexOf(e)>=0||(r+"").indexOf(e)>=0)&&i.push(_);l=t,_.__bT=setTimeout(_.wrapAsync(r),20)}else t(i)};r()},"__ax<click>"(){let e=this,t=e.__h;t.hasClass("_cF")?e.__a():t.hasClass("_cD")||e.__e()},"__bW<keyup,paste>"(e){let t=this;clearTimeout(t.__bV);let _=i.trim(e.eventTarget.value);t.__bV=setTimeout(t.wrapAsync(()=>{_!=t.__cd&&t.__bU(t.__cd=_,e=>{t.updater.digest({list:e})})}),300)},"__bX<click>"(e){let t=this,_=e.params.item,l=t.updater,c=l.get();s.has(t,"__cb")||(t.__cb=c.selected);let a=t.__bN,o=t.__bM,r=_,d=_;o&&a&&(d=_[o],r=_[a]);let p=[""];r&&(p=c.selected.split(","));let n=i.inArray("",p);n>-1&&p.splice(n,1),-1==(n=i.inArray(r+"",p))?p.push(r):p.splice(n,1),p.length||c.emptyText&&(p=[""]),r=p.join(","),l.digest({selected:t.__aB=r})},"__bY<change,focusin,focusout>"(e){e.stopPropagation()},"__a<click>"(e){this.__a(e.params.enter)},"__ce<click>"(){let e=this,t=e.__aB,_=e.__bL,i=e.__bN,l=e.updater;if(s.has(e,"__cb")||(e.__cb=t),t)t="";else{t="";for(let s,l=e.__bO?1:0;l<_.length;l++)s=_[l],i?s.group||(t+=s[i]+","):t+=s+",";t=t.slice(0,-1)}l.digest({selected:e.__aB=t})},"__cf<click>"(){let e=this,t=e.__aB,_=e.__bL,l=e.__bN,c=e.updater;s.has(e,"__cb")||(e.__cb=t);let a=t.split(",");t="";for(let s,c=e.__bO?1:0;c<_.length;c++)s=_[c],l?s.group||-1!=i.inArray(s[l]+"",a)||(t+=s[l]+","):-1==i.inArray(s+"",a)&&(t+=s+",");t=t.slice(0,-1),c.digest({selected:e.__aB=t})}})});