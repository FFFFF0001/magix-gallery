define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],function(e,t,i){var _=e("magix"),c=e("$"),a=e("../mx-monitor/index");_.applyStyle("_p","._cC{position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cC:hover{border-color:#ccc}._cD{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cE{cursor:not-allowed;background-color:#fbfbfb}._cE:hover{border-color:#e6e6e6}._cE ._cD{cursor:not-allowed}._cF{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cG ._cF{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cG,._cG:hover{border-color:#6363e6}._cH{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cI{color:#999}._cJ{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cG ._cJ{display:block}._cK{overflow:auto;max-height:192px;padding:4px 0}._cL{display:block;width:100%;padding:9px 9px 4px}._cM{padding:0;width:100%}._cN{color:#ccc;position:absolute;left:15px;top:18px}._cO{padding-left:28px;width:100%;height:28px;line-height:28px}._cP{padding:5px;color:#999;display:block;cursor:default}._cQ{padding:3px 4px}._cR{color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cS{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cT{color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cR:hover,._cT:hover{color:#333;background-color:#f0f0f0}._cU,._cU:active,._cU:focus,._cU:hover{color:#fff;background-color:#6363e6}._cV{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._cW{border-left:1px solid #e6e6e6}");var s=function(e,t,i,c,a){if(!e[t]||_.has(i,c)){var s=i[c]||"";a||(s+=""),e[t]=s}return e[t]};i.exports=_.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cD" mx-click="__aB()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cH<%if($$.phLabel){%> _cI<%}%>">2</span><span class="__ _cF">&#xe692;</span></div><div mx-guid="g2" class="_cJ">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["phLabel","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:'class="_cH<%if($$.phLabel){%> _cI<%}%>"',attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_cL"><label class="_cM"><span class="__ _cN">&#xe608;</span><input mx-keyup="__c_()" mx-paste="__c_()" mx-change="__cb()" mx-focusin="__cb()" mx-focusout="__cb()" placeholder="搜索关键词" class="_ap _cO"></label></div><%}%><ul mx-guid="g3" class="_cK" id="list_<%=$$.viewId%>">4</ul><div class="_cV _ai"><div class="_aa"><button type="button" class="_an _ao" mx-click="__a({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__a()">取消</button></div><div class="_aa _t _cW _R"><button type="button" class="_an" mx-click="__ci()">全选/不选</button><button type="button" class="_an _s" mx-click="__cj()">反选</button></div></div><%}%>',s:"3"},{keys:["selected","list","textKey","valueKey","emptyText"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var a=$$.selected.split(\',\'),b=void 0,c=void 0;for(var d=0;d<$$.list.length;d++){var e=$$.list[d];if(e&&e.group){%><li class="_cP _al" title="<%=e[$$.textKey]%>"><%=e[$$.textKey]%></li><%}else{if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}if($$.emptyText===c&&d===0){c=\'\';e=\'\';}var f=$$.inArray(c+\'\',a)>-1;if(c===\'\'){%><li title="<%=b%>" class="_cQ"><a href="#" class="_cR _al <%if(f){%> _cU<%}%>" mx-click="__ca({item:\'<%@e%>\'})"><%=b%></a></li><%}else{%><li class="_cQ _ai"><ul><%for(;d<$$.list.length;d++){e=$$.list[d];if(e&&e.group){d--;break;}if($$.textKey&&$$.valueKey){b=e[$$.textKey];c=e[$$.valueKey];}else{b=e;c=e;}var g=$$.inArray(c+\'\',a)>-1%><li class="_cS"><a href="#" class="_cT _al<%if(g){%> _cU<%}%>" mx-click="__ca({item:\'<%@e%>\'})"><%=b%></a></li><%}%></ul></li><%}}}%>',s:"4"}]},init:function(e){var t=this;a.__e(),t.on("destroy",function(){a.__g(t),a.__h()}),t.updater.set({viewId:t.id,inArray:c.inArray});var i=c("#"+t.id);t.__i=i,i.addClass("_cC"),t.assign(e)},assign:function(e){var t=this;s(t,"__bP",e,"list",1);var i=s(t,"__aF",e,"selected"),a=s(t,"__bQ",e,"textKey"),r=s(t,"__bR",e,"valueKey"),l=s(t,"__bS",e,"emptyText");if(t.__bT=e.searchbox+""=="true",t.__cc=e.disabled+""=="true",!t.__bP){var o,n=[];t.__i.children().each(function(e,t){t=c(t),o="true"==t.attr("group"),n.push({group:o,text:t.text(),value:o?_.guid():t.attr("value")})}),a=t.__bQ="text",r=t.__bR="value",t.__bP=n}var d=t.__bP,p=_.toMap(d,r);if(l)if(a&&r){if(!p[""]){var u={};u[a]=l,u[r]="",d.unshift(u),p[""]=u}}else p[l]||(d.unshift(l),p[""]=l);return t.__aF=i,t.__cd=p,t.updater.set({list:d}),!0},__j:function(e){var t=this;return _.inside(e,t.id)},render:function(){var e=this;e.__i[e.__cc?"addClass":"removeClass"]("_cE"),e.__ce(e.__aF)},__a:function(e){var t=this;if(t.__i.hasClass("_cG")){var i=t.updater.get();if(_.has(t,"__cf")){var c=e&&i.selected!==t.__cf;e?t.__ce(i.selected):t.__ce(t.__cf),c&&t.__i.val(i.selected).trigger({type:"change",keys:{text:i.textKey,value:i.valueKey},values:(i.selected+"").split(",")}),delete t.__cf}t.__i.removeClass("_cG").trigger("focusout"),a.__g(t)}},__f:function(){var e=this;if(!e.__i.hasClass("_cG")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__i.addClass("_cG").trigger("focusin");var t=c("#list_"+e.id),i=t.find("._cU").position();if(i){var _=t.height(),s=t.prop("scrollTop");if(i.top<0||i.top>_){var r=i.top-_+s+_/2;t.prop("scrollTop",r)}}a.__l(e)}},__cg:function(e,t){for(var i=this.__cd,_=[],c=0,a=e;c<a.length;c++){var s=a[c],r=i[s]||{};t?_.push(r[t]):_.push(s||r)}return _},__ce:function(e){var t=this;e=e||"",e+="";var i=t.__bQ||"",_=t.__bR||"",c=e.split(","),a="",s=t.__bP;c.length?a=t.__cg(c,i):(e=s[0],a=s[0],i&&_&&(a=(e=e[_])[i])),t.updater.digest({textKey:i,valueKey:_,emptyText:t.__bS,searchbox:t.__bT,phLabel:""===e,selected:t.__aF=e,selectedText:a}),t.__i.val(e)},__bY:function(e,t){var i=this;clearTimeout(i.__bX);var _=i.__bP,c=[],a=0,s=_.length,r=i.__bQ,l=i.__bR;if(e){var o=function(){if(a<s){for(var n=Math.min(a+400,s),d=a,p=void 0,u=void 0,f=void 0;d<n;d++)u=p=_[d],f=p,r&&l&&(u=p[r],f=p[l]),((u+"").indexOf(e)>=0||(f+"").indexOf(e)>=0)&&c.push(p);a=n,i.__bX=setTimeout(i.wrapAsync(o),20)}else t(c)};o()}else t(_)},"__aB<click>":function(){var e=this,t=e.__i;t.hasClass("_cG")?e.__a():t.hasClass("_cE")||e.__f()},"__c_<keyup,paste>":function(e){var t=this;clearTimeout(t.__bZ);var i=c.trim(e.eventTarget.value);t.__bZ=setTimeout(t.wrapAsync(function(){i!=t.__ch&&t.__bY(t.__ch=i,function(e){t.updater.digest({list:e})})}),300)},"__ca<click>":function(e){e.preventDefault();var t=this,i=e.params.item,a=t.updater,s=a.get();_.has(t,"__cf")||(t.__cf=s.selected);var r=t.__bR,l=t.__bQ,o=i;l&&r&&(i[l],o=i[r]);var n=[""];o&&(n=s.selected.split(","));var d=c.inArray("",n);d>-1&&n.splice(d,1),-1==(d=c.inArray(o+"",n))?n.push(o):n.splice(d,1),n.length||s.emptyText&&(n=[""]),o=n.join(","),a.digest({selected:t.__aF=o})},"__cb<change,focusin,focusout>":function(e){e.stopPropagation()},"__a<click>":function(e){this.__a(e.params.enter)},"__ci<click>":function(){var e=this,t=e.__aF,i=e.__bP,c=e.__bR,a=e.updater;if(_.has(e,"__cf")||(e.__cf=t),t)t="";else{t="";for(var s=e.__bS?1:0,r=void 0;s<i.length;s++)r=i[s],c?r.group||(t+=r[c]+","):t+=r+",";t=t.slice(0,-1)}a.digest({selected:e.__aF=t})},"__cj<click>":function(){var e=this,t=e.__aF,i=e.__bP,a=e.__bR,s=e.updater;_.has(e,"__cf")||(e.__cf=t);var r=t.split(",");t="";for(var l=e.__bS?1:0,o=void 0;l<i.length;l++)o=i[l],a?o.group||-1!=c.inArray(o[a]+"",r)||(t+=o[a]+","):-1==c.inArray(o+"",r)&&(t+=o+",");t=t.slice(0,-1),s.digest({selected:e.__aF=t})}})});