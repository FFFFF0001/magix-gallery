define("mx-dropdown/index",["magix","$","../mx-monitor/index"],function(e,t,i){var s=e("magix"),a=e("$"),o=e("../mx-monitor/index");s.applyStyle("n",".ca{position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}.ca:hover{border-color:#ccc}.cb{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px}.cc{cursor:not-allowed;background-color:#fbfbfb}.cc:hover{border-color:#e6e6e6}.cc .cb{cursor:not-allowed}.cd{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}.ce .cd{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}.ce,.ce:hover{border-color:#6363e6}.cf{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.cg{color:#999}.ch{position:absolute;top:100%;left:-1px;right:-1px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce .ch{display:block}.ci{overflow:auto;max-height:196px;padding:4px 0}.cj{display:block;width:100%;padding:9px 9px 4px}.ck{padding:0;width:100%}.cl{color:#ccc;position:absolute;left:15px;top:16px}.cm{padding-left:28px;height:28px;line-height:28px;width:100%}.cn{padding:5px;color:#999;display:block;cursor:default}.co{padding:0 4px;margin:2px 0}.cp{color:#666;display:block;width:100%;padding:0 12px;height:29px;line-height:29px;border-radius:4px}.cp:active,.cp:focus,.cp:hover{color:#333;background-color:#f0f0f0}.cq,.cq:active,.cq:focus,.cq:hover{color:#fff;background-color:#6363e6}");var c=function(e,t,i,s){if(!e[t]||i){var a=i||"";s||(a+=""),e[t]=a}return e[t]};i.exports=s.View.extend({tmpl:{html:'<div mx-guid="g0" class="cb" mx-click="__bM()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="cf<%if($$.selected===\'\'){%> cg<%}%>">2</span><span class="_ cd">&#xe692;</span></div><div mx-guid="g2" class="ch">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["selected","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:"class=\"cf<%if($$.selected===''){%> cg<%}%>\"",attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="cj"><label class="ck"><span class="_ cl">&#xe608;</span><input placeholder="搜索关键词" mx-keyup="__bO()" mx-paste="__bO()" mx-change="__bQ()" mx-focusin="__bQ()" mx-focusout="__bQ()" class="an cm"></label></div><%}%><ul mx-guid="g3" class="ci" id="list_<%=$$.viewId%>">4</ul><%}%>',s:"3"},{keys:["list","textKey","valueKey","selected"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var a=void 0,b=void 0;for(var c=0,d=$$.list;c<d.length;c++){var e=d[c];if($$.textKey&&$$.valueKey){a=e[$$.textKey];b=e[$$.valueKey];}else{a=e;b=e;}if(e&&e.group){%><li class="cn aj" title="<%=e[$$.textKey]%>"><%=e[$$.textKey]%></li><%}else{%><li title="<%=a%>" class="co"><%var f=(b+\'\')===($$.selected+\'\')%><a href="#" class="cp aj<%if(f){%> cq<%}%>" mx-click="__bP({item:\'<%@e%>\'})"><%=a%></a></li><%}}%>',s:"4"}]},init:function(e){var t=this;o.__d(),t.on("destroy",function(){o.__f(t),o.__g()}),t.updater.set({viewId:t.id});var i=a("#"+t.id);i.addClass("ca"),t.__h=i,t.assign(e)},assign:function(e){var t=this;c(t,"__bC",e.list,!0);var i=c(t,"__as",e.selected),o=c(t,"__bD",e.textKey),r=c(t,"__bE",e.valueKey),l=c(t,"__bF",e.emptyText);if(t.__bG=e.searchbox+""=="true",t.__bH=e.disabled+""=="true",!t.__bC){var n,_=[];t.__h.children().each(function(e,t){t=a(t),n="true"==t.attr("group"),_.push({group:n,text:t.text(),value:n?s.guid():t.attr("value")})}),o=t.__bD="text",r=t.__bE="value",t.__bC=_}var d=t.__bC,p=s.toMap(d,r);if(l)if(o&&r){if(!p[""]){var u={};u[o]=l,u[r]="",d.unshift(u),p[""]=u}}else p[l]||(d.unshift(l),p[l]=l);return i||!l||o||r||(i=l),i&&p[i]||(i=p[i]||d[0],o&&r&&(i=i[r])),t.__as=i,t.__bI=o&&r?p[i][o]:i,!0},__i:function(e){return s.inside(e,this.id)},render:function(){var e=this;e.__h[e.__bH?"addClass":"removeClass"]("cc"),e.__bJ(!0)},__a:function(){var e=this;e.__h.hasClass("ce")&&(e.__h.removeClass("ce").trigger("focusout"),o.__f(e))},__e:function(){var e=this;if(!e.__h.hasClass("ce")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("ce").trigger("focusin");var t=a("#list_"+e.id),i=t.find(".cq").position(),s=t.height(),c=t.prop("scrollTop");if(i.top<0||i.top>s){var r=i.top-s+c+s/2;t.prop("scrollTop",r)}o.__k(e)}},__bJ:function(e){var t=this,i=t.__as;t.updater.digest({textKey:t.__bD,valueKey:t.__bE,selected:i,searchbox:t.__bG,selectedText:t.__bI,list:t.__bC.slice()}),t.__h.val(i),e||t.__u(i)},__bL:function(e,t){var i=this;clearTimeout(i.__bK);var s=i.__bC,a=[],o=0,c=s.length,r=i.__bD,l=i.__bE;if(e){var n=function(){if(o<c){for(var _=Math.min(o+400,c),d=o,p=void 0,u=void 0,f=void 0;d<_;d++)u=p=s[d],f=p,r&&l&&(u=p[r],f=p[l]),((u+"").indexOf(e)>=0||(f+"").indexOf(e)>=0)&&a.push(p);o=_,i.__bK=setTimeout(i.wrapAsync(n),20)}else t(a)};n()}else t(s)},__u:function(e,t){var i=this,s=i.updater,o=i.__bE,c=i.__bD,r=i.__as,l=e,n=e;if(c&&o&&(n=e[c],l=e[o]),!t||r!==l){s.set({selected:i.__as=l});var _=a.Event("change",{item:e,keys:{text:c,value:o},value:o?e[o]:e,text:c?e[c]:e});i.__h.val(o?e[o]:e).trigger(_),_.isDefaultPrevented()?s.set({selected:r}):s.digest({selected:l,selectedText:n})}},"__bM<click>":function(){var e=this,t=e.__h;t.hasClass("ce")?e.__a():t.hasClass("cc")||e.__e()},"__bO<keyup,paste>":function(e){var t=this;e.stopPropagation(),clearTimeout(t.__bN);var i=a.trim(e.eventTarget.value);t.__bN=setTimeout(t.wrapAsync(function(){i!=t.$lVal&&t.__bL(t.$lVal=i,function(e){t.updater.digest({list:e})})}),300)},"__bP<click>":function(e){e.preventDefault(),e.stopPropagation();var t=this;t.__u(e.params.item,!0),t.__a()},"__bQ<change,focusin,focusout>":function(e){e.stopPropagation()}})});