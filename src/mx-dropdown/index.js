define("mx-dropdown/index",["magix","$","../mx-monitor/index"],(e,t,s)=>{let i=e("magix"),_=e("$"),l=e("../mx-monitor/index");i.applyStyle("_o","._ck{outline:0;position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._ck:hover{border-color:#ccc}._cl{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px}._cm{cursor:not-allowed;background-color:#fbfbfb}._cm:hover{border-color:#e6e6e6}._cm ._cl{cursor:not-allowed}._cn{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._co ._cn{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._ck:focus,._co,._co:hover{border-color:#f96447}._cp{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cq{color:#999}._cr{position:absolute;top:100%;left:-1px;right:-1px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._co ._cr{display:block}._cs{overflow:auto;max-height:196px;padding:4px 0}._ct{display:block;width:100%;padding:9px 9px 4px}._cu{padding:0;width:100%}._cv{color:#ccc;position:absolute;left:15px;top:16px}._cw{padding-left:28px;height:28px;line-height:28px;width:100%}._cx{padding:5px;color:#999;display:block;cursor:default}._cy{padding:0 4px;margin:2px 0}._cz{cursor:pointer;color:#666;display:block;width:100%;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cz:hover{color:#333;background-color:#f0f0f0}._cA,._cA:active,._cA:focus,._cA:hover{color:#fff;background-color:#f96447}");let o=(e,t,s,_,l)=>{if(!e[t]||i.has(s,_)){let i=s[_]||"";l||(i+=""),e[t]=i}return e[t]};s.exports=i.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cl" mx-click="__ax()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cp<%if($$.selected===\'\'){%> _cq<%}%>">2</span><span class="__ _cn">&#xe692;</span></div><div mx-guid="g2" class="_cr">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["selected","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:"class=\"_cp<%if($$.selected===''){%> _cq<%}%>\"",attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_ct"><label class="_cu"><span class="__ _cv">&#xe608;</span><input placeholder="搜索关键词" mx-keyup="__bW()" mx-paste="__bW()" mx-change="__bY()" mx-focusin="__bY()" mx-focusout="__bY()" class="_ap _cw"></label></div><%}%><ul mx-guid="g3" class="_cs" id="list_<%=$$.viewId%>">4</ul><%}%>',s:"3"},{keys:["list","textKey","valueKey","selected"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var _=void 0,a=void 0;for(var b=0,c=$$.list;b<c.length;b++){var d=c[b];if($$.textKey&&$$.valueKey){_=d[$$.textKey];a=d[$$.valueKey];}else{_=d;a=d;}if(d&&d.group){%><li class="_cx _al" title="<%=d[$$.textKey]%>"><%=d[$$.textKey]%></li><%}else{%><li title="<%=_%>" class="_cy"><%var e=(a+\'\')===($$.selected+\'\')%><span class="_cz _al<%if(e){%> _cA<%}%>" mx-click="__bX({item:\'<%@d%>\'})"><%=_%></span></li><%}}%>',s:"4"}]},init(e){let t=this;l.__d();let s=_("#"+t.id);s.addClass("_ck"),s.on("keydown",e=>{13==e.keyCode&&t["__ax<click>"]()}),t.on("destroy",()=>{s.off("keydown"),l.__f(t),l.__g()}),t.updater.set({viewId:t.id}),t.__h=s,t.assign(e)},assign(e){let t=this;o(t,"__bL",e,"list",1);let s=o(t,"__aB",e,"selected"),l=o(t,"__bM",e,"textKey"),a=o(t,"__bN",e,"valueKey"),c=o(t,"__bO",e,"emptyText");if(t.__bP=e.searchbox+""=="true",t.__bQ=e.disabled+""=="true",!t.__bL){let e,s=[];t.__h.children().each((t,l)=>{l=_(l),e="true"==l.attr("group"),s.push({group:e,text:l.text(),value:e?i.guid():l.attr("value")})}),l=t.__bM="text",a=t.__bN="value",t.__bL=s}let r=t.__bL,d=i.toMap(r,a);if(c)if(l&&a){if(!d[""]){let e={};e[l]=c,e[a]="",r.unshift(e),d[""]=e}}else d[c]||(r.unshift(c),d[c]=c);return s||!c||l||a||(s=c),s&&d[s]||(s=d[s]||r[0],l&&a&&(s=s[a])),t.__aB=s,t.__bR=l&&a?d[s][l]:s,!0},__i(e){return i.inside(e,this.id)},render(){this.__h[this.__bQ?"addClass":"removeClass"]("_cm").prop("tabindex",this.__bQ?-1:0),this.__bS(!0)},__a(){let e=this;e.__h.hasClass("_co")&&(e.__h.removeClass("_co").trigger("focusout"),l.__f(e))},__e(){let e=this;if(!e.__h.hasClass("_co")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("_co").trigger("focusin");let t=_("#list_"+e.id),s=t.find("._cA").position(),i=t.height(),o=t.prop("scrollTop");if(s.top<0||s.top>i){let e=s.top-i+o+i/2;t.prop("scrollTop",e)}l.__k(e)}},__bS(e){let t=this,s=t.__aB;t.updater.digest({textKey:t.__bM,valueKey:t.__bN,selected:s,searchbox:t.__bP,selectedText:t.__bR,list:t.__bL.slice()}),t.__h.val(s),e||t.__u(s)},__bU(e,t){let s=this;clearTimeout(s.__bT);let i=s.__bL,_=[],l=0,o=i.length,a=s.__bM,c=s.__bN;if(!e)return void t(i);let r=()=>{if(l<o){let t=Math.min(l+400,o);for(let s,o,r,d=l;d<t;d++)o=s=i[d],r=s,a&&c&&(o=s[a],r=s[c]),((o+"").indexOf(e)>=0||(r+"").indexOf(e)>=0)&&_.push(s);l=t,s.__bT=setTimeout(s.wrapAsync(r),20)}else t(_)};r()},__u(e,t){let s=this,i=s.updater,l=s.__bN,o=s.__bM,a=s.__aB,c=e,r=e;if(o&&l&&(r=e[o],c=e[l]),!t||a!==c){i.set({selected:s.__aB=c});let t=_.Event("change",{item:e,keys:{text:o,value:l},value:l?e[l]:e,text:o?e[o]:e});s.__h.val(l?e[l]:e).trigger(t),t.isDefaultPrevented()?i.set({selected:a}):i.digest({selected:c,selectedText:r})}},"__ax<click>"(){let e=this,t=e.__h;t.hasClass("_co")?e.__a():t.hasClass("_cm")||e.__e()},"__bW<keyup,paste>"(e){let t=this;e.stopPropagation(),clearTimeout(t.__bV);let s=_.trim(e.eventTarget.value);t.__bV=setTimeout(t.wrapAsync(()=>{s!=t.$lVal&&t.__bU(t.$lVal=s,e=>{t.updater.digest({list:e})})}),300)},"__bX<click>"(e){this.__u(e.params.item,!0),this.__a()},"__bY<change,focusin,focusout>"(e){e.stopPropagation()}})});