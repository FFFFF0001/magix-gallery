define("mx-storage/index",["magix"],function(e,t,a){var n,o,i,_=e("magix"),r={},l=!1,c={};o="localStorage";var s=function(){var e=(+new Date).toString(),t=JSON.stringify(c);r.__el=t,r.__em=e,"__en"==o&&(i.setAttribute("__em",e),i.setAttribute("__el",t),i.save("__eo"))},d=_.mix({set:function(e,t){c[e]=t,s()},get:function(e){return c[e]},del:function(e){delete c[e],s()}},_.Event);if(o in window)try{localStorage.setItem(o,_.guid()),l=!0,localStorage.removeItem(o)}catch(e){}if(l)r=localStorage,n=r.__em;else if((o="globalStorage")in window)try{var m=window[o];r="localhost"==location.hostname?m.__ep:m[location.hostname],n=r.__em}catch(e){}else if((i=document.createElement("link")).addBehavior){i.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(i);try{i.load("__eo")}catch(e){i.setAttribute("__eo","{}"),i.save("__eo"),i.load("__eo")}var g="{}";try{g=i.getAttribute("__eo"),n=i.getAttribute("__em")}catch(e){}o="__en",r.__el=g}var f=function(){var e;clearTimeout(f.timer),f.timer=setTimeout(function(){if("__en"==o){i.load("__eo");try{e=i.getAttribute("__em")}catch(e){}}else e=r.__em;if(e&&e!=n){n=e;var t=void 0,a="{}";if("__en"==o){i.load("__eo");try{a=i.getAttribute("__eo")}catch(e){}r.__el=a}t=JSON.parse(r.__el);for(var l={},s=0,m=_.keys(c).concat(_.keys(t));s<m.length;s++){var g=m[s];if(1!==l[g]){l[g]=1;var f=JSON.stringify(c[g]);JSON.stringify(t[g])!=f&&d.fire("change",{key:g,from:c[g],to:t[g]})}}c=t}},25)};if("addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&f()},!1),"__en"==o?setInterval(f,1e3):"addEventListener"in window?window.addEventListener("storage",f,!1):document.attachEvent("onstorage",f),r.__el)try{c=JSON.parse(r.__el)}catch(e){r.__el="{}"}else r.__el="{}";a.exports=d});