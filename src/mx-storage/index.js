define("mx-storage/index",["magix"],function(e,t,a){var _,i,n,r=e("magix"),o={},c=!1,s={};i="localStorage";var d=function(){var e=(+new Date).toString(),t=JSON.stringify(s);o.__e_=t,o.__ea=e,"__eb"==i&&(n.setAttribute("__ea",e),n.setAttribute("__e_",t),n.save("__ec"))},l=r.mix({set:function(e,t){s[e]=t,d()},get:function(e){return s[e]},del:function(e){delete s[e],d()}},r.Event);if(i in window)try{localStorage.setItem(i,r.guid()),c=!0,localStorage.removeItem(i)}catch(e){}if(c)o=localStorage,_=o.__ea;else if((i="globalStorage")in window)try{var g=window[i];o="localhost"==location.hostname?g.__ed:g[location.hostname],_=o.__ea}catch(e){}else if((n=document.createElement("link")).addBehavior){n.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(n);try{n.load("__ec")}catch(e){n.setAttribute("__ec","{}"),n.save("__ec"),n.load("__ec")}var f="{}";try{f=n.getAttribute("__ec"),_=n.getAttribute("__ea")}catch(e){}i="__eb",o.__e_=f}var u=function(){var e;clearTimeout(u.timer),u.timer=setTimeout(function(){if("__eb"==i){n.load("__ec");try{e=n.getAttribute("__ea")}catch(e){}}else e=o.__ea;if(e&&e!=_){_=e;var t=void 0,a="{}";if("__eb"==i){n.load("__ec");try{a=n.getAttribute("__ec")}catch(e){}o.__e_=a}t=JSON.parse(o.__e_);for(var c={},d=0,g=r.keys(s).concat(r.keys(t));d<g.length;d++){var f=g[d];if(1!==c[f]){c[f]=1;var u=JSON.stringify(s[f]);JSON.stringify(t[f])!=u&&l.fire("change",{key:f,from:s[f],to:t[f]})}}s=t}},25)};if("addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&u()},!1),"__eb"==i?setInterval(u,1e3):"addEventListener"in window?window.addEventListener("storage",u,!1):document.attachEvent("onstorage",u),o.__e_)try{s=JSON.parse(o.__e_)}catch(e){o.__e_="{}"}else o.__e_="{}";a.exports=l});