define("mx-storage/index",["magix"],function(e,t,a){var n,i,o,_=e("magix"),r={},c=!1,s={};i="localStorage";var d=function(){var e=(+new Date).toString(),t=JSON.stringify(s);r.__em=t,r.__en=e,"__eo"==i&&(o.setAttribute("__en",e),o.setAttribute("__em",t),o.save("__ep"))},l=_.mix({set:function(e,t){s[e]=t,d()},get:function(e){return s[e]},del:function(e){delete s[e],d()}},_.Event);if(i in window)try{localStorage.setItem(i,_.guid()),c=!0,localStorage.removeItem(i)}catch(e){}if(c)r=localStorage,n=r.__en;else if((i="globalStorage")in window)try{var m=window[i];r="localhost"==location.hostname?m.__eq:m[location.hostname],n=r.__en}catch(e){}else if((o=document.createElement("link")).addBehavior){o.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(o);try{o.load("__ep")}catch(e){o.setAttribute("__ep","{}"),o.save("__ep"),o.load("__ep")}var g="{}";try{g=o.getAttribute("__ep"),n=o.getAttribute("__en")}catch(e){}i="__eo",r.__em=g}var f=function(){var e;clearTimeout(f.timer),f.timer=setTimeout(function(){if("__eo"==i){o.load("__ep");try{e=o.getAttribute("__en")}catch(e){}}else e=r.__en;if(e&&e!=n){n=e;var t=void 0,a="{}";if("__eo"==i){o.load("__ep");try{a=o.getAttribute("__ep")}catch(e){}r.__em=a}t=JSON.parse(r.__em);for(var c={},d=0,m=_.keys(s).concat(_.keys(t));d<m.length;d++){var g=m[d];if(1!==c[g]){c[g]=1;var f=JSON.stringify(s[g]);JSON.stringify(t[g])!=f&&l.fire("change",{key:g,from:s[g],to:t[g]})}}s=t}},25)};if("addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&f()},!1),"__eo"==i?setInterval(f,1e3):"addEventListener"in window?window.addEventListener("storage",f,!1):document.attachEvent("onstorage",f),r.__em)try{s=JSON.parse(r.__em)}catch(e){r.__em="{}"}else r.__em="{}";a.exports=l});