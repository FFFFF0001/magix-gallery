define("mx-storage/index",["magix"],function(e,t,a){var _,i,n,r=e("magix"),o={},d=!1,c={};i="localStorage";var s=function(){var e=(+new Date).toString(),t=JSON.stringify(c);o.__dZ=t,o.__e_=e,"__ea"==i&&(n.setAttribute("__e_",e),n.setAttribute("__dZ",t),n.save("__eb"))},l=r.mix({set:function(e,t){c[e]=t,s()},get:function(e){return c[e]},del:function(e){delete c[e],s()}},r.Event);if(i in window)try{localStorage.setItem(i,r.guid()),d=!0,localStorage.removeItem(i)}catch(e){}if(d)o=localStorage,_=o.__e_;else if((i="globalStorage")in window)try{var g=window[i];o="localhost"==location.hostname?g.__ec:g[location.hostname],_=o.__e_}catch(e){}else if((n=document.createElement("link")).addBehavior){n.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(n);try{n.load("__eb")}catch(e){n.setAttribute("__eb","{}"),n.save("__eb"),n.load("__eb")}var f="{}";try{f=n.getAttribute("__eb"),_=n.getAttribute("__e_")}catch(e){}i="__ea",o.__dZ=f}var u=function(){var e;clearTimeout(u.timer),u.timer=setTimeout(function(){if("__ea"==i){n.load("__eb");try{e=n.getAttribute("__e_")}catch(e){}}else e=o.__e_;if(e&&e!=_){_=e;var t=void 0,a="{}";if("__ea"==i){n.load("__eb");try{a=n.getAttribute("__eb")}catch(e){}o.__dZ=a}t=JSON.parse(o.__dZ);for(var d={},s=0,g=r.keys(c).concat(r.keys(t));s<g.length;s++){var f=g[s];if(1!==d[f]){d[f]=1;var u=JSON.stringify(c[f]);JSON.stringify(t[f])!=u&&l.fire("change",{key:f,from:c[f],to:t[f]})}}c=t}},25)};if("addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&u()},!1),"__ea"==i?setInterval(u,1e3):"addEventListener"in window?window.addEventListener("storage",u,!1):document.attachEvent("onstorage",u),o.__dZ)try{c=JSON.parse(o.__dZ)}catch(e){o.__dZ="{}"}else o.__dZ="{}";a.exports=l});