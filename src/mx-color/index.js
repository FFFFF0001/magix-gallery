define("mx-color/index",["magix","$","../mx-dragdrop/index"],(t,e,s)=>{let a=t("magix"),i=t("$"),o=t("../mx-dragdrop/index");a.applyStyle("_i",'._bt{padding:10px;background-color:#fff;display:inline-block;border:1px solid #ccc;border-radius:5px;overflow-y:hidden}._bu{width:225px;zoom:1}._bu:after,._bu:before{display:table;content:""}._bu:after{clear:both}._bv{border:1px solid #000;float:left;width:15px;height:15px;margin:-1px 0 0 -1px;position:relative}._bw:before{content:" ";position:absolute;left:2px;top:2px;border:2px solid #e8e8e8;border-style:inset;width:9px;height:9px}._bx{margin:10px 0;height:200px}._by{position:relative;float:left}._bz{width:196px;height:196px}._bA{position:absolute;width:8px;height:8px;-webkit-box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);border-radius:50%;cursor:default}._bB{position:relative;float:left;margin-left:10px}._bC{width:18px;height:196px}._bD{position:absolute;left:2px;top:-2px;height:4px;width:14px;-webkit-box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);background:#fff;cursor:default}._bE{height:25px}._bF{width:104px;margin-right:5px;vertical-align:middle}._bG{width:50px;border-radius:4px;height:32px;display:inline-block;margin-right:10px;vertical-align:middle;border:1px solid #ddd}._bH{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==);width:224px;height:12px;margin-bottom:10px}._bI{height:100%}._bJ{position:absolute;left:-2px;top:2px;height:8px;width:4px;-webkit-box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);background:#fff;cursor:default}');let d={selected:"_bw",cnt:"_bt"},p=["d81e06","f4ea2a","1afa29","1296db","13227a","d4237a","ffffff","e6e6e6","dbdbdb","cdcdcd","bfbfbf","8a8a8a","707070","515151","2c2c2c","000000","ea986c","eeb174","f3ca7e","f9f28b","c8db8c","aad08f","87c38f","83c6c2","7dc5eb","87a7d6","8992c8","a686ba","bd8cbb","be8dbd","e89abe","e8989a","e16632","e98f36","efb336","f6ef37","afcd51","7cba59","36ab60","1baba8","17ace3","3f81c1","4f68b0","594d9c","82529d","a4579d","db649b","dd6572","d84e06","e0620d","ea9518","f4ea2a","8cbb1a","2ba515","0e932e","0c9890","1295db","0061b2","0061b0","004198","122179","88147f","d3227b","d6204b"],_=(t,e,s)=>{let a,i,o,d,p;t=t%360/60,a=i=o=s-(p=s*e);let _=255*(a+=[p,d=p*(1-Math.abs(t%2-1)),0,0,d,p][t=~~t]),r=255*(i+=[d,p,p,d,0,0][t]),l=255*(o+=[0,0,d,p,p,d][t]);return{r:_,g:r,b:l,hex:"#"+(16777216|l|r<<8|_<<16).toString(16).slice(1)}};s.exports=a.View.extend({tmpl:{html:'<div id="shortcuts_<%=$$.id%>"><ul class="_bu"><%for(var _=0;_<$$.shortcuts.length;_++){%><li class="_bv" id="sc_<%=$$.shortcuts[_]%>_<%=$$.id%>" style="background:#<%=$$.shortcuts[_]%>" mx-click="__ai({color:\'#<%=$eq($$.shortcuts[_])%>\'})"></li><%}%></ul></div><div class="_bx"><div class="_by"><div class="_bz" id="cpicker_<%=$$.id%>" mx-mousedown="__ag()"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%"><defs><lineargradient id="gb_<%=$$.id%>" x1="0%" y1="100%" x2="0%" y2="0%"><stop offset="0%" stop-color="#000000" stop-opacity="1"></stop><stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop></lineargradient><lineargradient id="gw_<%=$$.id%>" x1="0%" y1="100%" x2="100%" y2="100%"><stop offset="0%" stop-color="#FFFFFF" stop-opacity="1"></stop><stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop></lineargradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#gw_<%=$$.id%>)"></rect><rect x="0" y="0" width="100%" height="100%" fill="url(#gb_<%=$$.id%>)"></rect></svg><div class="_bA" id="ph_<%=$$.id%>"></div></div></div><div class="_bB"><div class="_bC" mx-mousedown="__af()"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%"><defs><linearGradient id="ghsv_<%=$$.id%>" x1="0%" y1="100%" x2="0%" y2="0%"><stop offset="0%" stop-color="#FF0000" stop-opacity="1"></stop><stop offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop><stop offset="25%" stop-color="#8000FF" stop-opacity="1"></stop><stop offset="38%" stop-color="#0040FF" stop-opacity="1"></stop><stop offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop><stop offset="63%" stop-color="#00FF40" stop-opacity="1"></stop><stop offset="75%" stop-color="#0BED00" stop-opacity="1"></stop><stop offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop><stop offset="100%" stop-color="#FF0000" stop-opacity="1"></stop></linearGradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#ghsv_<%=$$.id%>)"></rect></svg><div class="_bD" id="sh_<%=$$.id%>"></div></div></div></div><%if($$.alpha){%><div class="_bH _ag"><div class="_bI _ag" id="at_<%=$$.id%>" mx-mousedown="__ah()"><div class="_bJ" id="ai_<%=$$.id%>"></div></div></div><%}%><div class="_bE"><span class="_bG" id="bgcolor_<%=$$.id%>"></span><input class="_ap _bF" readonly="readonly" id="val_<%=$$.id%>"><%if($$.btns){%><button class="_an _ao" type="button" mx-click="__aj();">确定</button><%}%></div>',subs:[]},init(t){let e=this;e.__W=t.color||"#ffffff",e.__X=t.showAlpha+""=="true",e.__Y=t.showBtns+""=="true",e.__Z={h:0,s:1,v:1},i("#"+e.id).addClass(d.cnt)},render(){let t=this;t.updater.digest({id:t.id,alpha:t.__X,btns:t.__Y,shortcuts:p}),t.__a_(t.__W)},__ac(t,e){let s=this,a=s.__Z;a.h=t.h%360,a.s=t.s,a.v=t.v;let o=_(t.h,t.s,t.v).hex,p=i("#cpicker_"+s.id),r=_(t.h,1,1);if(p.css("background",r.hex),s.__aa=o,s.__ab(),!e){i("#shortcuts_"+s.id+" li").removeClass(d.selected);let t=Math.round(196*a.h/360-2);i("#sh_"+s.id).css({top:t}),t=Math.round(196*(1-a.v)-4);let e=Math.round(196*a.s-4);i("#ph_"+s.id).css({left:e,top:t})}i("#sc_"+o.substr(1,6)+"_"+s.id).addClass(d.selected)},__a_(t){let e=this,s=parseInt(t.substr(1,2),16),a=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16),o=parseInt(t.substr(7,2),16);isNaN(o)&&(o=255),e.__ad=("0"+o.toString(16)).slice(-2);let d=((t,e,s)=>{t/=255,e/=255,s/=255;let a,i,o,d;return o=Math.max(t,e,s),d=o-Math.min(t,e,s),a=0===d?null:o==t?(e-s)/d+(e<s?6:0):o==e?(s-t)/d+2:(t-e)/d+4,a=a%6*60,i=0===d?0:d/o,{h:a,s:i,v:o}})(s,a,i);e.__ac(d),e.__X&&e.__ae(o)},"__af<mousedown>"(t){let e=this,s=i(t.eventTarget),a=i("#sh_"+e.id),d=t,p=s.offset(),_=(t.pageY-p.top)/196*360;e.__ac({h:_,s:e.__Z.s,v:e.__Z.v});let r=parseInt(a.css("top"),10);o.begin(t.eventTarget,t=>{let s=t.pageY-d.pageY;(s+=r)<=-2?s=-2:s>=194&&(s=194),a.css({top:s});let i=(s+2)/196*360;e.__ac({h:i,s:e.__Z.s,v:e.__Z.v},!0)},()=>{e.__u()})},"__ag<mousedown>"(t){let e=this,s=i(t.eventTarget).offset(),a=(t.pageX-s.left)/196,d=(196-(t.pageY-s.top))/196;e.__ac({h:e.__Z.h,s:a,v:d});let p=i("#ph_"+e.id),_=parseInt(p.css("left"),10),r=parseInt(p.css("top"),10),l=t;o.begin(t.eventTarget,t=>{let s=t.pageY-l.pageY,a=t.pageX-l.pageX;(s+=r)<=-4?s=-4:s>=192&&(s=192),(a+=_)<=-4?a=-4:a>=192&&(a=192),p.css({top:s,left:a});let i=(a+4)/196,o=(196-(s+4))/196;e.__ac({h:e.__Z.h,s:i,v:o})},()=>{e.__u()})},__ae(t){t/=255,t*=224,t-=2,i("#ai_"+this.id).css({left:t})},__ab(){let t=this,e=t.__aa;i("#at_"+t.id).css({background:"linear-gradient(to right, "+e+"00 0%,"+e+" 100%)"}),t.__X&&(e+=t.__ad),i("#bgcolor_"+t.id).css("background",e),i("#val_"+t.id).val(e)},"__ah<mousedown>"(t){let e=i(t.eventTarget),s=t,a=this,d=i("#ai_"+a.id),p=e.offset(),_=(t.pageX-p.left)/224*255|0;a.__ad=("0"+_.toString(16)).slice(-2),a.__ae(_),a.__ab();let r=parseInt(d.css("left"),10);o.begin(t.eventTarget,t=>{let e=t.pageX-s.pageX;(e+=r)<=-2?e=-2:e>=222&&(e=222),d.css({left:e});let i=Math.round((e+2)/224*255);a.__ad=("0"+i.toString(16)).slice(-2),a.__ab()},()=>{a.__u()})},"__ai<click>"(t){this.__a_(t.params.color),i(t.eventTarget).addClass(d.selected),this.__u()},__u(t){let e=this;if(!e.__Y||t){let t=i("#val_"+e.id).val();t!=e.__W&&i("#"+e.id).trigger({type:"change",color:e.__W=t})}},"__aj<click>"(){this.__u(1)}})});