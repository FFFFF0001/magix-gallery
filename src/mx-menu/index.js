define("mx-menu/index",["magix","$","../mx-monitor/index"],function(e,_,t){var i=e("magix"),a=e("$"),n=e("../mx-monitor/index"),r=i.Vframe;i.applyStyle("x",".e_{-webkit-transition:margin-left .25s;transition:margin-left .25s}.ea{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}.eb{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}.ec{color:#fff;background-color:#6363e6}.ed{margin-left:10px}.ee{margin-left:-10px}.ef{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var s=null,c={left:"ee",right:"ed"},o=function(e,_,t){for(var a={},n={},r=[],s=0,c=e.length;s<c;s++){var o=i.mix({},e[s]);a[o[_]]=o,n[o[_]]&&(o.children=n[o[_]]),i.has(o,t)&&""!==o[t]?a[o[t]]?(a[o[t]].children||(a[o[t]].children=[])).push(o):n[o[t]]?n[o[t]].push(o):n[o[t]]=[o]:r.push(o)}return{list:r,map:a}};t.exports=i.View.extend({tmpl:{html:'<div mx-guid="g0" style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>" mx-mouseover="__cq();" class="e_<%if($$.isChild){%> away<%}%>" mx-contextmenu="__D()"><ul mx-guid="g1" class="ea ah">2</ul></div>',subs:[{keys:["width","isChild","contextMenu"],path:'div[mx-guid="g0"]',attr:'style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>" mx-mouseover="__cq();" class="e_<%if($$.isChild){%> away<%}%>"',attrs:[{n:"style"},{n:"mx-mouseover"},{n:"class",p:1,f:"className"}]},{keys:["list","valueKey","textKey","viewId"],path:'ul[mx-guid="g1"]',tmpl:'<%for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="aj eb" mx-mouseover="__da({id:\'<%=$eq(b[$$.valueKey])%>\'})" mx-mouseout="__da({id:\'<%=$eq(b[$$.valueKey])%>\'});\n            " <%if(!b.children){%> mx-click="__bP({id:\'<%=$eq(b[$$.valueKey])%>\'})" <%}%> title="<%=b[$$.textKey]%>" id="<%=$$.viewId%>_<%=b[$$.valueKey]%>"><%=b[$$.textKey]%> <%if(b.children){%><span class="a_ _ ef">&#xe61e;</span><%}%></li><%}%>',s:"2"}]},init:function(e){var _=this;_.assign(e),_.__cL=e.__cL,_.__cM=e.__cM,_.__cN=e.picked,_.__cO||(n.__d(),_.on("destroy",function(){n.__f(_),n.__g()}))},assign:function(e){var _=this,t=e.width||340,i=e.valueKey||"id",a=e.parentKey||"pId",n=e.textKey||"text",r=e.__cO;if(r)_.__bS=e.__bS,_.__bC=e.list;else{var s=o(e.list,i,a);_.__bS=s.map,_.__bC=s.list}return _.__cO=r,_.__at=t,_.__cP=i,_.__cQ=a,_.__cR=n,_.__cS=e.pId,_.__cT=e.__cT,!0},render:function(){var e=this;e.$u.digest({viewId:e.id,contextMenu:e.__cL,isChild:e.__cO,list:e.__bC,width:e.__at,valueKey:e.__cP,textKey:e.__cR}),e.__cL&&e.__e(e.__cM)},__i:function(e){var _=this,t=i.inside(e,_.id);if(!t)for(var a=_.owner.children(),n=a.length;n--;){var s=r.get(a[n]);if(s&&(t=s.invoke("__i",e)))break}return t},__e:function(e,_){var t=this;if(!t.__j){t.__j=1;var i=a("#"+t.id+" div"),r=a(document),o=-1,d=-1,l="right",u=i.outerWidth(),f=i.outerHeight(),m=0,v=0;if(_){var h=_.offset();m=_.outerWidth(),v=_.outerHeight(),o=h.left+m,d=h.top}else o=e.pageX,d=e.pageY;o+u>r.width()&&(l="left",(o=o-u-m)<0&&(o=0)),d+f>r.height()&&(d-=f,(d+=v)<0&&(d=0)),_&&("right"==l?o-=10:o+=10);var p=t.__cT||t;s!=p&&(s=p),t.__cO?i.css({left:o,top:d}).addClass(c[l]):i.css({left:o,top:d}),p.__cU||(p.__cU=1,n.__k(t))}},__a:function(){for(var e=this,_=e.owner.children(),t=_.length-1;t>=0;t--){var i=r.get(_[t]);i&&i.invoke("__a")}if(e.__j){e.__j=!1;var s=a("#"+e.id+" div");e.__cO?(s.removeClass(c.left).removeClass(c.right),s.css({left:-1e5}),e.__cO.removeClass("ec")):(e.__cL&&s.css({left:-1e4}),delete e.__cU,n.__f(e))}},__cW:function(e){clearTimeout(this["__cV"+e])},__cY:function(e,_,t){var i=this;i["__cX"+_]=setTimeout(i.wrapAsync(function(){var n=i.id+"_menu_"+_,s=r.get(n);s||(a("body").append('<div id="'+n+'" />'),s=i.owner.mountVframe(n,"mx-menu/index",{__cO:a("#"+i.id+"_"+_),width:i.__at,valueKey:i.__cP,textKey:i.__cR,parentKey:i.__cQ,list:t,pId:_,__cT:i.__cT||i,__bS:i.__bS})),s.invoke("__e",[null,e],!0)}),250)},__cZ:function(e){var _=this,t=_.id+"_menu_"+e,i=r.get(t);i&&(_["__cV"+e]=setTimeout(_.wrapAsync(function(){i.invoke("__a")}),50))},"__da<mouseover,mouseout>":function(e){var _=this;if(!i.inside(e.relatedTarget,e.eventTarget)){var t=a(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("ec");var n=e.params.id;if(_.__cZ(_.__d_),"mouseover"==e.type){var r=_.__bS[n].children;r&&(_.__cW(n),_.__cY(t,n,r),_.__d_=n)}else clearTimeout(_["__cX"+n])}},"__cq<mouseover>":function(e){var _=this;!i.inside(e.relatedTarget,e.eventTarget)&&(_.__cO||s==_||s&&s.__a(),_.__cO&&(a(_.__cO).addClass("ec"),_.owner.parent().invoke("__cW",[_.__cS])))},"__bP<click>":function(e){var _=this,t=_.__cT||_,i=a("#"+t.id),n={type:"pick",item:_.__bS[e.params.id]};i.trigger(n),t.__a();var r=_.__cN;r&&r(n.item)},"__D<contextmenu>":function(e){e.preventDefault()}},{show:function(e,_,t){var n=_.eventTarget;n.id||(n.id=i.guid());var r="ctx_"+n.id,s=i.Vframe.get(r);s?s.invoke("__e",[_],!0):(a("body").append('<div id="'+r+'" />'),t=t||{},i.mix(t,{__cL:1,__cM:_}),s=e.owner.mountVframe(r,"mx-menu/index",t))}})});