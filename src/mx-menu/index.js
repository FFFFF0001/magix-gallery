define("mx-menu/index",["magix","$","../mx-monitor/index"],function(e,_,t){var i=e("magix"),n=e("$"),a=e("../mx-monitor/index"),r=i.Vframe;i.applyStyle("_y","._dM{-webkit-transition:margin-left .25s;transition:margin-left .25s}._dN{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._dO{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._dP{color:#fff;background-color:#6363e6}._dQ{margin-left:10px}._dR{margin-left:-10px}._dS{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var d=null,c={left:"_dR",right:"_dQ"},s=function(e,_,t){for(var n={},a={},r=[],d=0,c=e.length;d<c;d++){var s=i.mix({},e[d]);n[s[_]]=s,a[s[_]]&&(s.children=a[s[_]]),i.has(s,t)&&""!==s[t]?n[s[t]]?(n[s[t]].children||(n[s[t]].children=[])).push(s):a[s[t]]?a[s[t]].push(s):a[s[t]]=[s]:r.push(s)}return{list:r,map:n}};t.exports=i.View.extend({tmpl:{html:'<div mx-guid="g0" style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>" mx-mouseover="__db();" class="_dM" mx-contextmenu="__D()"><ul mx-guid="g1" class="_dN _ai">2</ul></div>',subs:[{keys:["width","isChild","contextMenu"],path:'div[mx-guid="g0"]',attr:'style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>"',attrs:[{n:"style"}]},{keys:["list","valueKey","textKey","viewId"],path:'ul[mx-guid="g1"]',tmpl:'<%for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_ak _dO" mx-mouseover="__da({id:\'<%=$eq(b[$$.valueKey])%>\'})" mx-mouseout="__da({id:\'<%=$eq(b[$$.valueKey])%>\'});\n            " <%if(!b.children){%> mx-click="__bQ({id:\'<%=$eq(b[$$.valueKey])%>\'})" <%}%> title="<%=b[$$.textKey]%>" id="<%=$$.viewId%>_<%=b[$$.valueKey]%>"><%=b[$$.textKey]%> <%if(b.children){%><span class="_aa __ _dS">&#xe61e;</span><%}%></li><%}%>',s:"2"}]},init:function(e){var _=this;_.assign(e),_.__cK=e.__cK,_.__cL=e.__cL,_.__cM=e.picked,_.__cN||(a.__d(),_.on("destroy",function(){a.__f(_),a.__g()}))},assign:function(e){var _=this,t=e.width||340,i=e.valueKey||"id",n=e.parentKey||"pId",a=e.textKey||"text",r=e.__cN;if(r)_.__bT=e.__bT,_.__bE=e.list;else{var d=s(e.list,i,n);_.__bT=d.map,_.__bE=d.list}return _.__cN=r,_.__cO=t,_.__cP=i,_.__cQ=n,_.__cR=a,_.__cS=e.pId,_.__cT=e.__cT,!0},render:function(){var e=this;e.updater.digest({viewId:e.id,contextMenu:e.__cK,isChild:e.__cN,list:e.__bE,width:e.__cO,valueKey:e.__cP,textKey:e.__cR}),e.__cK&&e.__e(e.__cL)},__i:function(e){var _=this,t=i.inside(e,_.id);if(!t)for(var n=_.owner.children(),a=n.length;a--;){var d=r.get(n[a]);if(d&&(t=d.invoke("__i",e)))break}return t},__e:function(e,_){var t=this;if(!t.__j){t.__j=1;var i=n("#"+t.id+" div"),r=n(document),s=-1,o=-1,l="right",u=i.outerWidth(),f=i.outerHeight(),v=0,m=0;if(_){var p=_.offset();v=_.outerWidth(),m=_.outerHeight(),s=p.left+v,o=p.top}else s=e.pageX,o=e.pageY;s+u>r.width()&&(l="left",(s=s-u-v)<0&&(s=0)),o+f>r.height()&&(o-=f,(o+=m)<0&&(o=0)),_&&("right"==l?s-=10:s+=10);var h=t.__cT||t;d!=h&&(d=h),t.__cN?i.css({left:s,top:o}).addClass(c[l]):i.css({left:s,top:o}),h.__cU||(h.__cU=1,a.__k(t))}},__a:function(){for(var e=this,_=e.owner.children(),t=_.length-1;t>=0;t--){var i=r.get(_[t]);i&&i.invoke("__a")}if(e.__j){e.__j=!1;var d=n("#"+e.id+" div");e.__cN?(d.removeClass(c.left).removeClass(c.right),d.css({left:-1e5}),e.__cN.removeClass("_dP")):(e.__cK&&d.css({left:-1e4}),delete e.__cU,a.__f(e))}},__cW:function(e){clearTimeout(this["__cV"+e])},__cY:function(e,_,t){var i=this;i["__cX"+_]=setTimeout(i.wrapAsync(function(){var a=i.id+"_menu_"+_,d=r.get(a);d||(n("body").append('<div id="'+a+'" />'),d=i.owner.mountVframe(a,"mx-menu/index",{__cN:n("#"+i.id+"_"+_),width:i.__cO,valueKey:i.__cP,textKey:i.__cR,parentKey:i.__cQ,list:t,pId:_,__cT:i.__cT||i,__bT:i.__bT})),d.invoke("__e",[null,e],!0)}),250)},__cZ:function(e){var _=this,t=_.id+"_menu_"+e,i=r.get(t);i&&(_["__cV"+e]=setTimeout(_.wrapAsync(function(){i.invoke("__a")}),50))},"__da<mouseover,mouseout>":function(e){var _=this;if(!i.inside(e.relatedTarget,e.eventTarget)){var t=n(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("_dP");var a=e.params.id;if(_.__cZ(_.__d_),"mouseover"==e.type){var r=_.__bT[a].children;r&&(_.__cW(a),_.__cY(t,a,r),_.__d_=a)}else clearTimeout(_["__cX"+a])}},"__db<mouseover>":function(e){var _=this;!i.inside(e.relatedTarget,e.eventTarget)&&(_.__cN||d==_||d&&d.__a(),_.__cN&&(n(_.__cN).addClass("_dP"),_.owner.parent().invoke("__cW",[_.__cS])))},"__bQ<click>":function(e){var _=this,t=_.__cT||_,i=n("#"+t.id),a={type:"pick",item:_.__bT[e.params.id]};i.trigger(a),t.__a();var r=_.__cM;r&&r(a.item)},"__D<contextmenu>":function(e){e.preventDefault()}},{show:function(e,_,t){var a=_.eventTarget;a.id||(a.id=i.guid());var r="ctx_"+a.id,d=i.Vframe.get(r);d?d.invoke("__e",[_],!0):(n("body").append('<div id="'+r+'" />'),t=t||{},i.mix(t,{__cK:1,__cL:_}),d=e.owner.mountVframe(r,"mx-menu/index",t))}})});