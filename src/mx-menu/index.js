define("mx-menu/index",["magix","$","../mx-monitor/index"],(e,_,t)=>{let i=e("magix"),d=e("$"),l=e("../mx-monitor/index"),s=i.Vframe;i.applyStyle("_y","._dQ{-webkit-transition:margin-left .25s;transition:margin-left .25s}._dR{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._dS{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._dT{color:#fff;background-color:#f96447}._dU{margin-left:10px}._dV{margin-left:-10px}._dW{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");let a=null,r={left:"_dV",right:"_dU"};t.exports=i.View.extend({tmpl:{html:'<div mx-guid="g0" style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>" mx-mouseover="__dk();" class="_dQ" mx-contextmenu="__D()"><ul mx-guid="g1" class="_dR _aj">2</ul></div>',subs:[{keys:["width","isChild","contextMenu"],path:'div[mx-guid="g0"]',attr:'style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-1000000px<%}%>"',attrs:[{n:"style"}]},{keys:["list","valueKey","textKey","viewId"],path:'ul[mx-guid="g1"]',tmpl:'<%for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_al _dS" mx-mouseover="__dj({id:\'<%=$eq(a[$$.valueKey])%>\'})" mx-mouseout="__dj({id:\'<%=$eq(a[$$.valueKey])%>\'});\n            " <%if(!a.children){%> mx-click="__bX({id:\'<%=$eq(a[$$.valueKey])%>\'})" <%}%> title="<%=a[$$.textKey]%>" id="<%=$$.viewId%>_<%=a[$$.valueKey]%>"><%=a[$$.textKey]%> <%if(a.children){%><span class="_ab __ _dW">&#xe61e;</span><%}%></li><%}%>',s:"2"}]},init(e){let _=this;_.assign(e),_.__cT=e.__cT,_.__cU=e.__cU,_.__cV=e.picked,_.__cW||(l.__d(),_.on("destroy",()=>{l.__f(_),l.__g()}))},assign(e){let _=this,t=e.width||340,d=e.valueKey||"id",l=e.parentKey||"pId",s=e.textKey||"text",a=e.__cW;if(a)_.__c_=e.__c_,_.__bL=e.list;else{let t=((e,_,t)=>{let d={},l={},s=[];for(let a=0,r=e.length;a<r;a++){let r=i.mix({},e[a]);d[r[_]]=r,l[r[_]]&&(r.children=l[r[_]]),i.has(r,t)&&""!==r[t]?d[r[t]]?(d[r[t]].children||(d[r[t]].children=[])).push(r):l[r[t]]?l[r[t]].push(r):l[r[t]]=[r]:s.push(r)}return{list:s,map:d}})(e.list,d,l);_.__c_=t.map,_.__bL=t.list}return _.__cW=a,_.__cX=t,_.__cY=d,_.__cZ=l,_.__d_=s,_.__da=e.pId,_.__db=e.__db,!0},render(){let e=this;e.updater.digest({viewId:e.id,contextMenu:e.__cT,isChild:e.__cW,list:e.__bL,width:e.__cX,valueKey:e.__cY,textKey:e.__d_}),e.__cT&&e.__e(e.__cU)},__i(e){let _=this,t=i.inside(e,_.id);if(!t){let i=_.owner.children();for(let _=i.length;_--;){let d=s.get(i[_]);if(d&&(t=d.invoke("__i",e)))break}}return t},__e(e,_){let t=this;if(!t.__j){t.__j=1;let i=d("#"+t.id+" div"),s=d(document),n=-1,o=-1,c="right",u=i.outerWidth(),m=i.outerHeight(),h=0,p=0;if(_){let e=_.offset();h=_.outerWidth(),p=_.outerHeight(),n=e.left+h,o=e.top}else n=e.pageX,o=e.pageY;n+u>s.width()&&(c="left",(n=n-u-h)<0&&(n=0)),o+m>s.height()&&(o-=m,(o+=p)<0&&(o=0)),_&&("right"==c?n-=10:n+=10);let x=t.__db||t;a!=x&&(a=x),t.__cW?i.css({left:n,top:o}).addClass(r[c]):i.css({left:n,top:o}),x.__dc||(x.__dc=1,l.__k(t))}},__a(){let e=this,_=e.owner.children();for(let e=_.length-1;e>=0;e--){let t=s.get(_[e]);t&&t.invoke("__a")}if(e.__j){e.__j=!1;let _=d("#"+e.id+" div");e.__cW?(_.removeClass(r.left).removeClass(r.right),_.css({left:-1e5}),e.__cW.removeClass("_dT")):(e.__cT&&_.css({left:-1e4}),delete e.__dc,l.__f(e))}},__de(e){clearTimeout(this["__dd"+e])},__dg(e,_,t){let i=this;i["__df"+_]=setTimeout(i.wrapAsync(()=>{let l=i.id+"_menu_"+_,a=s.get(l);a||(d("body").append('<div id="'+l+'" />'),a=i.owner.mountVframe(l,"mx-menu/index",{__cW:d("#"+i.id+"_"+_),width:i.__cX,valueKey:i.__cY,textKey:i.__d_,parentKey:i.__cZ,list:t,pId:_,__db:i.__db||i,__c_:i.__c_})),a.invoke("__e",[null,e],!0)}),250)},__dh(e){let _=this,t=_.id+"_menu_"+e,i=s.get(t);i&&(_["__dd"+e]=setTimeout(_.wrapAsync(()=>{i.invoke("__a")}),50))},"__dj<mouseover,mouseout>"(e){let _=this;if(!i.inside(e.relatedTarget,e.eventTarget)){let t=d(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("_dT");let i=e.params.id;if(_.__dh(_.__di),"mouseover"==e.type){let e=_.__c_[i].children;e&&(_.__de(i),_.__dg(t,i,e),_.__di=i)}else clearTimeout(_["__df"+i])}},"__dk<mouseover>"(e){let _=this;!i.inside(e.relatedTarget,e.eventTarget)&&(_.__cW||a==_||a&&a.__a(),_.__cW&&(d(_.__cW).addClass("_dT"),_.owner.parent().invoke("__de",[_.__da])))},"__bX<click>"(e){let _=this.__db||this,t=d("#"+_.id),i={type:"pick",item:this.__c_[e.params.id]};t.trigger(i),_.__a();let l=this.__cV;l&&l(i.item)},"__D<contextmenu>"(e){e.preventDefault()}},{show(e,_,t){let l=_.eventTarget;l.id||(l.id=i.guid());let s="ctx_"+l.id,a=i.Vframe.get(s);a?a.invoke("__e",[_],!0):(d("body").append('<div id="'+s+'" />'),t=t||{},i.mix(t,{__cT:1,__cU:_}),a=e.owner.mountVframe(s,"mx-menu/index",t))}})});