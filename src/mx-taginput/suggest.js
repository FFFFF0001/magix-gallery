define("mx-taginput/suggest",["magix","$","../mx-monitor/index"],function(_,e,t){var i=_("magix"),o=_("$"),r=_("../mx-monitor/index");i.applyStyle("_J","._fg{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._fh{padding:0 4px;cursor:pointer;margin:2px 0}._fi{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._fj,._fi:active,._fi:focus,._fi:hover{color:#333;background-color:#f0f0f0}._fj{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_fg _ai" style="width:<%=$$.width%>px" mx-mouseout="__ep()" mx-mousemove="__eq()" mx-contextmenu="__D()">1</ul>',subs:[{keys:["width","rList","list","viewId","textKey"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var a=0,b;a<$$.list.length;a++){b=$$.list[a]%><li class="_fh"><a href="#" class="_fi" data-idx="<%!a%>" mx-click="__eo({item:\'<%@b%>\'})" id="sg_<%!$$.viewId%>_<%!a%>"><%=$$.textKey?b[$$.textKey]:b%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init:function(_){var e=this;e.__fz=_.scrollTop||0,e.__ee=_.list||[],e.__cF=0|(_.offsetLeft||0),r.__d(),e.on("destroy",function(){r.__f(e),r.__g(),e.__h.off("keyup paste input",e.__ef).off("focus",e.__eg)}),e.updater.set({viewId:e.id,width:_.width||340,textKey:_.textKey,valueKey:_.valueKey}),e.__fA=-1,e.__fB=[e.id,"suggest_"+e.id],_.relateIds&&(e.__fB=e.__fB.concat(_.relateIds.split(",")))},__i:function(_){for(var e=this.__fB,t=0;t<e.length;t++)if(i.inside(_,e[t]))return!0;return!1},__fD:function(_,e){var t=this;e||(t.__ee=_),t.__fA=-1,t.updater.digest({list:t.__fC=_}),t.__cD&&(_&&_.length?t.__cD.addClass("_fg"):t.__cD.removeClass("_fg"))},render:function(){var _=this,e=o("#"+_.id);_.__h=e,e.on("focus",_.__eg=o.proxy(_.__e,_)).on("keyup paste input",_.__ef=o.proxy(_.__ej,_));var t="suggest_"+_.id;o("<div />").attr("id",t).insertAfter(e),_.updater.to(t),_.__fD(_.__ee),_.__cD=o("#"+t+" ul"),_.__ee&&_.__ee.length||_.__cD.removeClass("_fg"),setTimeout(_.wrapAsync(function(){_.__cD.prop("scrollTop",_.__fz)}),0)},__ej:function(_){var e=this;e.__j||e.__e();var t=e.__fC;if(40==_.keyCode)e.__ek(),e.__fA++,e.__fA>=t.length&&(e.__fA=0),e.__el();else if(38==_.keyCode)e.__ek(),e.__fA--,e.__fA<0&&(e.__fA=t.length-1),e.__el();else if(13==_.keyCode){if(e.__fA>-1&&e.__fA<e.__fC.length){var i=e.__fC[e.__fA];e.__h.trigger({type:"pick",item:i}),e.__ek(),e.__fA=-1,e.__a()}}else{var r=o.trim(_.target.value);if(r!=e.__cd)if(e.__cd=r,r){for(var s=[],f=e.__ee.slice(),a=e.updater.get("textKey"),n=0,l=void 0;n<f.length;n++)l=f[n],((a?l[a]:l)+"").indexOf(r)>=0&&s.push(l);e.__fD(s,!0)}else e.__fD(e.__ee,!0)}},__e:function(){var _=this,e=_.updater;if(!_.__j){_.__j=!0,e.get("rList")||e.digest({rList:!0}),r.__k(_);var t=_.__h.position();_.__cD.show().css({left:t.left+_.__cF,top:t.top+_.__h.outerHeight()+10}),_.__h.trigger("showlist")}},__ek:function(){var _=this;o("#sg_"+_.id+"_"+_.__fA).removeClass("_fj")},__el:function(_){var e=this,t=o("#sg_"+e.id+"_"+e.__fA);if(t.addClass("_fj"),!_&&t.length){e.__en=1;var i=t.outerHeight(),r=(e.__fA+1)*i,s=e.__cD,f=s.height(),a=s.prop("scrollTop"),n=Math.ceil(f/i);r<a+i?s.prop("scrollTop",r-i):r>a+f&&s.prop("scrollTop",(e.__fA+2-n)*i)}},__a:function(){var _=this;_.__j&&(_.__j=!1,r.__f(_),_.__cD.hide(),_.__h.trigger("hidelist"))},"__eo<click>":function(_){_.preventDefault();var e=this,t=_.params.item;e.__h.trigger({type:"pick",item:t,scrollTop:e.__cD.prop("scrollTop")}),e.__a()},"__ep<mouseout>":function(_){if(!i.inside(_.relatedTarget,_.eventTarget)){var e=this;e.__ek(),e.__fA=-1}},"__eq<mousemove>":function(_){var e=this;if(e.__en)delete e.__en;else{var t=o(_.target);if(t.is("li")){var i=t.data("idx");i!=e.__fA&&(e.__ek(),e.__fA=i,e.__el(!0))}}},"__D<contextmenu>":function(_){_.preventDefault()}})});