define("mx-taginput/suggest",["magix","$","../mx-monitor/index"],(_,e,t)=>{let i=_("magix"),s=_("$"),l=_("../mx-monitor/index");i.applyStyle("_K","._fm{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._fn{padding:0 4px;cursor:pointer;margin:2px 0}._fo{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._fp,._fo:active,._fo:focus,._fo:hover{color:#333;background-color:#f0f0f0}._fp{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_fm _aj" style="width:<%=$$.width%>px" mx-mouseout="__eF()" mx-mousemove="__eG()" mx-contextmenu="__D()">1</ul>',subs:[{keys:["width","rList","list","viewId","textKey"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_fn"><a href="#" class="_fo" data-idx="<%!_%>" mx-click="__eE({item:\'<%@a%>\'})" id="sg_<%!$$.viewId%>_<%!_%>"><%=$$.textKey?a[$$.textKey]:a%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px"',attrs:[{n:"style"}],mask:"21111"}]},init(_){let e=this;e.__fR=_.scrollTop||0,e.__eu=_.list||[],e.__cO=0|(_.offsetLeft||0),l.__d(),e.on("destroy",function(){l.__f(e),l.__g(),e.__h.off("keyup paste input",e.__ev).off("focus",e.__ew),s("#suggest_"+e.id).remove()}),e.updater.set({viewId:e.id,width:_.width||340,textKey:_.textKey,valueKey:_.valueKey}),e.__fS=-1,e.__fT=[e.id,"suggest_"+e.id],_.relateIds&&(e.__fT=e.__fT.concat(_.relateIds.split(",")))},__i(_){let e=this.__fT;for(let t=0;t<e.length;t++)if(i.inside(_,e[t]))return!0;return!1},__fV(_,e){let t=this;e||(t.__eu=_),t.__fS=-1,t.updater.digest({list:t.__fU=_}),t.__cM&&(_&&_.length?t.__cM.addClass("_fm"):t.__cM.removeClass("_fm"))},render(){let _=this,e=s("#"+_.id);_.__h=e,e.on("focus",_.__ew=s.proxy(_.__e,_)).on("keyup paste input",_.__ev=s.proxy(_.__ez,_));let t="suggest_"+_.id;s("<div />").attr("id",t).insertAfter(e),_.updater.to(t),_.__fV(_.__eu),_.__cM=s("#"+t+" ul"),_.__eu&&_.__eu.length||_.__cM.removeClass("_fm"),setTimeout(_.wrapAsync(()=>{_.__cM.prop("scrollTop",_.__fR)}),0)},__ez(_){let e=this;e.__j||e.__e();let t=e.__fU;if(40==_.keyCode)e.__eA(),e.__fS++,e.__fS>=t.length&&(e.__fS=0),e.__eB();else if(38==_.keyCode)e.__eA(),e.__fS--,e.__fS<0&&(e.__fS=t.length-1),e.__eB();else if(13==_.keyCode){if(e.__fS>-1&&e.__fS<e.__fU.length){let _=e.__fU[e.__fS];e.__h.trigger({type:"pick",item:_}),e.__eA(),e.__fS=-1,e.__a()}}else{let t=s.trim(_.target.value);if(t!=e.__cm)if(e.__cm=t,t){let _,i=[],s=e.__eu.slice(),l=e.updater.get("textKey");for(let e,o=0;o<s.length;o++)e=s[o],((_=l?e[l]:e)+"").indexOf(t)>=0&&i.push(e);e.__fV(i,!0)}else e.__fV(e.__eu,!0)}},__e(){let _=this,e=_.updater;if(!_.__j){_.__j=!0;e.get("rList")||e.digest({rList:!0}),l.__k(_);let t=_.__h.position();_.__cM.show().css({left:t.left+_.__cO,top:t.top+_.__h.outerHeight()+10}),_.__h.trigger("showlist")}},__eA(){s("#sg_"+this.id+"_"+this.__fS).removeClass("_fp")},__eB(_){let e=this,t=s("#sg_"+e.id+"_"+e.__fS);if(t.addClass("_fp"),!_&&t.length){e.__eD=1;let _=t.outerHeight(),i=(e.__fS+1)*_,s=e.__cM,l=s.height(),o=s.prop("scrollTop"),r=Math.ceil(l/_);i<o+_?s.prop("scrollTop",i-_):i>o+l&&s.prop("scrollTop",(e.__fS+2-r)*_)}},__a(){let _=this;_.__j&&(_.__j=!1,l.__f(_),_.__cM.hide(),_.__h.trigger("hidelist"))},"__eE<click>"(_){_.preventDefault();let e=_.params.item;this.__h.trigger({type:"pick",item:e,scrollTop:this.__cM.prop("scrollTop")}),this.__a()},"__eF<mouseout>"(_){if(!i.inside(_.relatedTarget,_.eventTarget)){this.__eA(),this.__fS=-1}},"__eG<mousemove>"(_){let e=this;if(e.__eD)return void delete e.__eD;let t=s(_.target);if(t.is("li")){let _=t.data("idx");_!=e.__fS&&(e.__eA(),e.__fS=_,e.__eB(!0))}},"__D<contextmenu>"(_){_.preventDefault()}})});