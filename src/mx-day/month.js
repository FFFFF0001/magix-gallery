define("mx-day/month",["magix","$","mx-dragselect/index"],function(a,e,_){a("mx-dragselect/index");var t=a("magix");t.applyStyle("_k","._bO{padding:0;height:38.4px;overflow:hidden;cursor:default;border:none;border-right:1px solid #e6e6e6}._bP{border-right:none}._bQ{background-color:#8282e6}._bR{opacity:0}._bS{cursor:not-allowed;background-color:#fbfbfb}");var r=a("$"),n={MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6,SUN:0},d={1:"MON",2:"TUE",3:"WED",4:"THU",5:"FRI",6:"SAT",0:"SUN"},i=function(a,e){return 32-new Date(a,e,32).getDate()},s=function(a,e){a=(a=a||"").slice(0,e);for(var _=0;_<e;_++)a.length<=_&&(a+="0");return a},o=function(a){for(var e={},_=a.length;_--;)"1"===a.charAt(_)&&(e[_]=1);return e};_.exports=t.View.extend({tmpl:{html:'<table class="_W _X"><tbody><tr mx-guid="g0" mx-change="__e()" mx-dragbegin="__aI()" mx-dragfinish="__aJ()" mx-view="mx-dragselect/index?selector=td%5Benable%3Dtrue%5D">1</tr></tbody></table>',subs:[{keys:["days","selected"],path:'tr[mx-guid="g0"]',tmpl:'<%for(var a=0;a<31;a++){%><td data-day="<%=a%>" enable="<%=a<$$.days?true:false%>" class="_bO<%if($$.selected.charAt(a)===\'1\'){%> _bQ<%}if(a==30){%> _bP<%}if(a>=$$.days){%> _bS<%}%>"><span class="_bR"><%=(\'0\'+(a+1)).slice(-2)%></span></td><%}%>',s:"1"}]},init:function(a){var e=this;e.assign(a),e.__h=r("#"+e.id)},assign:function(a){var e=this,_=i(a.year,a.month);return e.__aB=_,e.__aC=a.year,e.__aD=a.month,e.__aE=s(a.selected,_),!0},__p:function(a){var e=this;if(a){var _=e.__aB;e.__aE=s(a,_),e.render()}},__aw:function(a,e){for(var _=this,t=_.__aE,r=_.__aC,d=_.__aD,i=_.__aB,s=n[a],o=1;o<=i;o++)new Date(r,d,o).getDay()===s&&(t=t.slice(0,o-1)+(e?"1":"0")+t.slice(o));_.__aE=t,_.render(!0)},render:function(a){var e=this;e.updater.digest({days:e.__aB,selected:e.__aE}),e.__aF=o(e.__aE),e.__h.trigger({type:"sync",ignoreSync:a,days:e.__aE})},__at:function(){for(var a=this,e=a.__aE,_=a.__aC,r=a.__aD,n=a.__aB,i={},s=1;s<=n;s++)if("1"!=e.charAt(s-1)){var o=new Date(_,r,s);i[d[o.getDay()]]=1}return t.keys(i)},"__e<change,click>":function(a){a.stopPropagation();var e=r(a.node),_=this,n=_.updater.get(),d=e.data("day"),i=_.__aF,s=_.__aG;"add"==a.action?i[d]?(e.removeClass("_bQ"),delete i[d],"drag"==a.mode&&(s[d]=1)):(e.addClass("_bQ"),i[d]=1,"drag"==a.mode&&delete s[d]):"remove"==a.action&&(s[d]?(e.addClass("_bQ"),i[d]=1,"drag"==a.mode&&delete s[d]):(e.removeClass("_bQ"),delete i[d],"drag"==a.mode&&(s[d]=1)));for(var o=_.__aB,c="",g=0;g<o;g++)t.has(i,g)?c+="1":c+="0";n.selected=_.__aE=c,"click"==a.mode&&_.__h.trigger({type:"change",days:c})},"__aI<dragbegin>":function(a){a.stopPropagation();var e=this;e.__aH=e.__aE,e.__aG={}},"__aJ<dragfinish>":function(a){a.stopPropagation();var e=this;e.__aE!=e.__aH&&e.__h.trigger({type:"change",days:e.__aE}),delete e.__aG}})});