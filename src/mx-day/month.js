define("mx-day/month",["magix","$","mx-dragselect/index"],function(a,e,t){a("mx-dragselect/index");var _=a("magix");_.applyStyle("_k","._bL{padding:0;height:38.4px;overflow:hidden;cursor:default;border:none;border-right:1px solid #e6e6e6}._bM{border-right:none}._bN{background-color:#8282e6}._bO{opacity:0}._bP{cursor:not-allowed;background-color:#fbfbfb}");var r=a("$"),n={MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6,SUN:0},d={1:"MON",2:"TUE",3:"WED",4:"THU",5:"FRI",6:"SAT",0:"SUN"},i=function(a,e){return 32-new Date(a,e,32).getDate()},s=function(a,e){a=(a=a||"").slice(0,e);for(var t=0;t<e;t++)a.length<=t&&(a+="0");return a},o=function(a){for(var e={},t=a.length;t--;)"1"===a.charAt(t)&&(e[t]=1);return e};t.exports=_.View.extend({tmpl:{html:'<table class="_W"><tbody><tr mx-guid="g0" mx-change="__e()" mx-dragbegin="__ay()" mx-dragfinish="__az()" mx-view="mx-dragselect/index?selector=td%5Benable%3Dtrue%5D">1</tr></tbody></table>',subs:[{keys:["days","selected"],path:'tr[mx-guid="g0"]',tmpl:'<%for(var a=0;a<31;a++){%><td data-day="<%=a%>" enable="<%=a<$$.days?true:false%>" class="_bL<%if($$.selected.charAt(a)===\'1\'){%> _bN<%}if(a==30){%> _bM<%}if(a>=$$.days){%> _bP<%}%>"><span class="_bO"><%=(\'0\'+(a+1)).slice(-2)%></span></td><%}%>',s:"1"}]},init:function(a){var e=this;e.assign(a),e.__h=r("#"+e.id)},assign:function(a){var e=this,t=i(a.year,a.month);return e.__ar=t,e.__as=a.year,e.__at=a.month,e.__au=s(a.selected,t),!0},__p:function(a){var e=this;if(a){var t=e.__ar;e.__au=s(a,t),e.render()}},__am:function(a,e){for(var t=this,_=t.__au,r=t.__as,d=t.__at,i=t.__ar,s=n[a],o=1;o<=i;o++)new Date(r,d,o).getDay()===s&&(_=_.slice(0,o-1)+(e?"1":"0")+_.slice(o));t.__au=_,t.render(!0)},render:function(a){var e=this;e.updater.digest({days:e.__ar,selected:e.__au}),e.__av=o(e.__au),e.__h.trigger({type:"sync",ignoreSync:a,days:e.__au})},__aj:function(){for(var a=this,e=a.__au,t=a.__as,r=a.__at,n=a.__ar,i={},s=1;s<=n;s++)if("1"!=e.charAt(s-1)){var o=new Date(t,r,s);i[d[o.getDay()]]=1}return _.keys(i)},"__e<change,click>":function(a){a.stopPropagation();var e=r(a.node),t=this,n=t.updater.get(),d=e.data("day"),i=t.__av,s=t.__aw;"add"==a.action?i[d]?(e.removeClass("_bN"),delete i[d],"drag"==a.mode&&(s[d]=1)):(e.addClass("_bN"),i[d]=1,"drag"==a.mode&&delete s[d]):"remove"==a.action&&(s[d]?(e.addClass("_bN"),i[d]=1,"drag"==a.mode&&delete s[d]):(e.removeClass("_bN"),delete i[d],"drag"==a.mode&&(s[d]=1)));for(var o=t.__ar,c="",g=0;g<o;g++)_.has(i,g)?c+="1":c+="0";n.selected=t.__au=c,"click"==a.mode&&t.__h.trigger({type:"change",days:c})},"__ay<dragbegin>":function(a){a.stopPropagation();var e=this;e.__ax=e.__au,e.__aw={}},"__az<dragfinish>":function(a){a.stopPropagation();var e=this;e.__au!=e.__ax&&e.__h.trigger({type:"change",days:e.__au}),delete e.__aw}})});