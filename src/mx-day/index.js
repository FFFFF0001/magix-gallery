define("mx-day/index",["magix","$","mx-dropdown/index","./month"],function(e,a,t){e("mx-dropdown/index"),e("./month");var d=e("magix"),i=e("$");d.applyStyle("i",".bE{padding:0;height:38.4px;text-align:center}");var s=function(e){(e=(e=e||"").split(",")).length>12&&(e=e.slice(0,12));for(var a=0;a<12;a++)e[a]||(e[a]="");return e},n=[{key:"MON",day:"一"},{key:"TUE",day:"二"},{key:"WED",day:"三"},{key:"THU",day:"四"},{key:"FRI",day:"五"},{key:"SAT",day:"六"},{key:"SUN",day:"日"}];t.exports=d.View.extend({tmpl:{html:'<table><thead><tr><th class="bE">周期设置</th><th mx-guid="g0" colspan="31">1</th></tr><tr mx-guid="g1">2</tr></thead><tbody mx-guid="g3">4</tbody></table>',subs:[{keys:["weeks","viewId"],path:'th[mx-guid="g0"]',tmpl:'<%for(var a=0;a<$$.weeks.length;a++){%><label class="j"><input mx-change="__an({key:\'<%=$eq($$.weeks[a].key)%>\'})" id="<%=$$.viewId%>_<%=$$.weeks[a].key%>" type="checkbox" class="aq">每周<%=$$.weeks[a].day%></label><%}%>',s:"1"},{keys:["width"],path:'tr[mx-guid="g1"]',tmpl:'<th class="bE"><div mx-guid="g2" mx-change="__al()" style="width:80px" class="g s" mx-view="mx-dropdown/index?list=<%@$$.years%>&selected=<%!$eu($$.selectedYear)%>"></div></th><%for(var b=0;b<31;b++){%><th class="bE" style="width:<%=$$.width%>px"><%=(\'0\'+(b+1)).slice(-2)%></th><%}%>',s:"2"},{keys:["years","selectedYear"],path:'div[mx-guid="g2"]',attr:'mx-view="mx-dropdown/index?list=<%@$$.years%>&selected=<%!$eu($$.selectedYear)%>"',attrs:[{n:"mx-view",v:1}]},{keys:["selectedYear","width","days"],path:'tbody[mx-guid="g3"]',tmpl:'<%for(var c=0;c<12;c++){%><tr><td class="bE"><%=(\'0\'+(c+1)).slice(-2)%></td><td class="bE" colspan="31"><div mx-change="__ao({m:<%!c%>})" mx-sync="__ao({m:<%!c%>})" mx-view="mx-day/month?year=<%!$eu($$.selectedYear)%>&month=<%!$eu(c)%>&width=<%!$eu($$.width)%>&selected=<%!$eu($$.days[c])%>"></div></td></tr><%}%>',s:"4"}]},init:function(e){var a=this;a.assign(e);var t=i("#"+a.id);a.__h=t},assign:function(e){var a=this;return a.__ag=e.years,a.__ah=e.selectedYear||e.years[0],a.__ai=s(e.selectedDays),!0},render:function(){var e=this,a=e.__h;e.$u.digest({viewId:e.id,weeks:n,years:e.__ag,selectedYear:e.__ah,days:e.__ai,width:Math.floor((a.width()-90)/31)})},__ak:function(){for(var e={},a=n.length;a--;)e[n[a].key]=1;var t=this;t.__h.find('[mx-view*="mx-day/month"]').each(function(a,t){for(var d=t.vframe.invoke("__aj"),i=d.length;i--;)delete e[d[i]]});for(a=n.length;a--;){var d=n[a].key;i("#"+t.id+"_"+d).prop("checked",!!e[d])}},"__al<change>":function(e){e.stopPropagation(),this.$u.digest({selectedYear:e.value})},"__an<change>":function(e){this.__h.find('[mx-view*="mx-day/month"]').each(function(a,t){t.vframe.invoke("__am",[e.params.key,e.eventTarget.checked])})},"__ao<change,sync>":function(e){e.stopPropagation();var a=this,t=a.__ai;t[e.params.m]=e.value,11!=e.params.m&&"change"!=e.type||(e.ignoreSync||a.__ak(),a.__h.trigger({type:"change",days:t}))}})});