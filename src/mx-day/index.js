define("mx-day/index",["magix","$","mx-dropdown/index","./month"],function(e,a,t){e("mx-dropdown/index"),e("./month");var i=e("magix"),s=e("$");i.applyStyle("_j","._bH{padding:0;height:38.4px;text-align:center}._bI{text-align:left;padding-left:10px}._bJ{border:none}._bK{border-right:1px solid #e6e6e6}");var _=function(e){(e=(e=e||"").split(",")).length>12&&(e=e.slice(0,12));for(var a=0;a<12;a++)e[a]||(e[a]="");return e},n=[{key:"MON",day:"一"},{key:"TUE",day:"二"},{key:"WED",day:"三"},{key:"THU",day:"四"},{key:"FRI",day:"五"},{key:"SAT",day:"六"},{key:"SUN",day:"日"}];t.exports=i.View.extend({tmpl:{html:'<table class="_W"><thead><tr><th class="_bH" width="120">周期设置</th><th mx-guid="g0" class="_bH _bI" colspan="31">1</th></tr><tr><th class="_bH"><div mx-guid="g1" mx-change="__al()" style="width:100px" class="_g _s" mx-view="mx-dropdown/index?list=<%@$$.years%>&selected=<%!$eu($$.selectedYear)%>"></div></th><th colspan="31" class="_bH"><table class="_W"><tbody><tr><%for(var b=0;b<31;b++){%><td class="_bH _bJ<%if(b<30){%> _bK<%}%>"><%=(\'0\'+(b+1)).slice(-2)%></td><%}%></tr></tbody></table></th></tr></thead><tbody mx-guid="g3">4</tbody></table>',subs:[{keys:["weeks","viewId"],path:'th[mx-guid="g0"]',tmpl:'<%for(var a=0;a<$$.weeks.length;a++){%><label class="_j"><input mx-change="__an({key:\'<%=$eq($$.weeks[a].key)%>\'})" id="<%=$$.viewId%>_<%=$$.weeks[a].key%>" type="checkbox" class="_ar">每周<%=$$.weeks[a].day%></label><%}%>',s:"1"},{keys:["years","selectedYear"],path:'div[mx-guid="g1"]',attr:'mx-view="mx-dropdown/index?list=<%@$$.years%>&selected=<%!$eu($$.selectedYear)%>"',attrs:[{n:"mx-view",v:1}]},{keys:["viewId","selectedYear","days"],path:'tbody[mx-guid="g3"]',tmpl:'<%for(var c=0;c<12;c++){%><tr><td class="_bH _ac" mx-click="__aq({m:<%!c%>})"><%=(\'0\'+(c+1)).slice(-2)%></td><td class="_bH" colspan="31" id="months_<%=c%>_<%=$$.viewId%>" mx-change="__ap({m:<%!c%>})" mx-sync="__ap({m:<%!c%>})" mx-view="mx-day/month?year=<%!$eu($$.selectedYear)%>&month=<%!$eu(c)%>&selected=<%!$eu($$.days[c])%>"></td></tr><%}%>',s:"4"}]},init:function(e){var a=this;a.assign(e);var t=s("#"+a.id);a.__h=t},assign:function(e){var a=this;return a.__ag=e.years,a.__ah=e.selectedYear||e.years[0],a.__ai=_(e.selectedDays),!0},render:function(){var e=this;e.updater.digest({viewId:e.id,weeks:n,years:e.__ag,selectedYear:e.__ah,days:e.__ai})},__ak:function(){for(var e={},a=n.length;a--;)e[n[a].key]=1;var t=this;t.__h.find('[mx-view*="mx-day/month"]').each(function(a,t){for(var i=t.vframe.invoke("__aj"),s=i.length;s--;)delete e[i[s]]});for(a=n.length;a--;){var i=n[a].key;s("#"+t.id+"_"+i).prop("checked",!!e[i])}},"__al<change>":function(e){e.stopPropagation();var a=this,t=a.__ai,i=t.join(",");t=_(""),a.updater.digest({days:t,selectedYear:e.value}),i!=a.__ai.join(",")&&a.__u()},__u:function(){var e=this;e.__h.trigger({type:"change",days:e.__ai})},"__an<change>":function(e){var a=this;e.stopPropagation(),a.__h.find('[mx-view*="mx-day/month"]').each(function(a,t){var i=t.vframe;i&&i.invoke("__am",[e.params.key,e.eventTarget.checked])}),a.__u()},"__ap<change,sync>":function(e){e.stopPropagation();var a=this;a.__ai[e.params.m]=e.days,e.ignoreSync||(clearTimeout(a.__ao),a.__ao=setTimeout(function(){a.__ak()},20)),"change"==e.type&&a.__u()},"__aq<click>":function(e){var a=this,t=e.params.m,i=s("#months_"+t+"_"+a.id),_=a.__ai[t];_=new Array(_.length+1).join(_.indexOf("0")>-1?"1":0),i.invokeView("__p",[_]),a.__u()}})});