define("mx-dialog/index",["magix","$","./alert","./confirm"],(i,e,t)=>{let o=i("magix");i("./alert"),i("./confirm"),o.applyStyle("_l","._bS{position:absolute}._bT{position:relative;background-color:#fff;border-radius:4px;border:1px solid #e6e6e6}._bU{position:absolute;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;margin:13px 15px 0 0;cursor:pointer;background:transparent;border:0;float:right;font-size:21px;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;filter:alpha(opacity=20);opacity:.2;z-index:1041;top:16px;right:10px;margin:0}._bU:focus,._bU:hover{color:#000;text-decoration:none;cursor:pointer;filter:alpha(opacity=50);opacity:.5}._bV{font-size:22px;font-weight:400}._bW{position:fixed;top:0;right:0;left:0;bottom:0;background-color:#000;filter:alpha(opacity=50);opacity:.5;display:none;z-index:1039}._bX{-webkit-filter:blur(3px);filter:blur(3px)}._bY{-webkit-animation:_b .3s;animation:_b .3s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}._bZ{position:absolute;right:10px;top:0;width:1px;height:0}._c_{padding:80px 0}@-webkit-keyframes _b{0%{opacity:0}to{opacity:.5}}@keyframes _b{0%{opacity:0}to{opacity:.5}}._ca{-webkit-animation:_c .2s;animation:_c .2s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes _c{0%{opacity:.5}to{opacity:0}}@keyframes _c{0%{opacity:.5}to{opacity:0}}._cb{margin-bottom:50px;min-height:60px}._cc{position:fixed;width:100%;height:100%;overflow:auto;left:0;top:0}._cd{-webkit-animation:_d .3s;animation:_d .3s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes _d{0%{margin-top:-50px;opacity:0}to{margin-top:0;opacity:1}}@keyframes _d{0%{margin-top:-50px;opacity:0}to{margin-top:0;opacity:1}}._ce{-webkit-animation:_e .2s;animation:_e .2s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes _e{0%{margin-top:0;opacity:1}to{margin-top:-50px;opacity:0}}@keyframes _e{0%{margin-top:0;opacity:1}to{margin-top:-50px;opacity:0}}");let a=i("$"),l=a(window),n=500,d=[];t.exports=o.View.extend({tmpl:{html:'<div class="_bW _bY" style="display:block;z-index:<%=$$.zIndex-1%>" id="mask_<%=$$.viewId%>"></div><div class="_cc" style="z-index:<%=$$.zIndex%>"><div class="_bS _cd" data-spm-protocol="i" id="body_<%=$$.viewId%>" style="left:<%=$$.left%>px;top:<%=$$.top%>px;width:<%=$$.width%>px"><input id="focus_<%=$$.viewId%>" class="_bZ"><button type="button" mx-click="__aN()" class="_bU <%=$$.closable?\'\':\'_ah\'%>"><span class="__ _bV">&#xe67f;</span></button><div class="_bT _cb" id="cnt_<%=$$.viewId%>"><div class="_aC _c_"><span class="_aD"></span></div></div></div></div>',subs:[]},init(i){let e=this,t=a("#app");e.on("destroy",()=>{(i=>{for(let e,t=d.length-1;t>=0;t--)if((e=d[t]).id==i.id){d.splice(t,1);break}})(e),500==(n-=2)&&t.removeClass("_bX"),a("#"+e.id).trigger("close").remove()}),o.has(i,"closable")||(i.closable=!0),e.updater.set(i),500==n&&t.addClass("_bX"),n+=2,d.push(e)},render(){let i=this,e=i.updater,t=e.get();e.set({zIndex:n,viewId:i.id}).digest(),a("#"+i.id).show(),a("#focus_"+i.id).focus(),i.owner.mountVframe("cnt_"+i.id,t.view,t),setTimeout(i.wrapAsync(()=>{a("#body_"+i.id).removeClass("_cd"),a("#mask_"+i.id).removeClass("_bY")}),300)},__aM(i){o.Vframe.get("cnt_"+this.id).invoke("fire",["unload",i])},"__aN<click>"(){a("#"+this.id).trigger("dlg_close")},"$doc<keyup>"(i){if(27==i.keyCode){let i=d[d.length-1];if(i==this&&i.updater.get("closable")){a("#"+i.id).trigger("dlg_close")}}}},{__aO(i,e){let t=o.guid("dlg_");a(document.body).append('<div id="'+t+'" style="display:none" />');let l,n=i.owner.mountVframe(t,"mx-dialog/index",e),d=a("#"+t);return d.on("dlg_close",()=>{if(!d.data("closing")&&!l){let e=()=>{d.data("closing",1),a("#body_"+t).addClass("_ce"),a("#mask_"+t).addClass("_ca"),setTimeout(()=>{i.owner&&i.owner.unmountVframe(t)},200)},o={prevent(){l=1},resolve(){o.p=1,l=0,e()},reject(){o.p=1,l=0}};n.invoke("__aM",o),l||o.p||e()}})},alert(i,e,t){this.confirm(i,e,null,t,"alert")},confirm(i,e,t,o,a){this.mxDialog("mx-dialog/"+(a||"confirm"),{body:i,cancelCallback:t,enterCallback:e,title:o,modal:!0,width:400,closable:!1,left:(l.width()-400)/2,top:Math.max((l.height()-220)/2,0)})},mxDialog(i,e){let t,a,n=this,d={view:i};return o.use(i,n.wrapAsync(s=>{let r="$dlg_"+i;n[r]||(n[r]=1,o.mix(d,s.dialogOptions),o.mix(d,e),d.width||(d.width=500),d.left||(d.left=(l.width()-d.width)/2),d.top||(d.top=100),d.dialog={close(){t&&t.trigger("dlg_close")}},(t=n.__aO(n,d)).on("close",()=>{delete n[r],a&&a()}))})),{close(){t&&t.trigger("dlg_close")},whenClose(i){a=i}}}})});